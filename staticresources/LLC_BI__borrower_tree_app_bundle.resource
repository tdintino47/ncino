!function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module.default}:function getModuleExports(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=15)}([function(module,exports){module.exports=function(useSourceMap){var list=[];return list.toString=function toString(){return this.map(function(item){var content=function cssWithMappingToString(item,useSourceMap){var content=item[1]||"",cssMapping=item[3];if(!cssMapping)return content;if(useSourceMap&&"function"==typeof btoa){var sourceMapping=function toComment(sourceMap){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))+" */"}(cssMapping),sourceURLs=cssMapping.sources.map(function(source){return"/*# sourceURL="+cssMapping.sourceRoot+source+" */"});return[content].concat(sourceURLs).concat([sourceMapping]).join("\n")}return[content].join("\n")}(item,useSourceMap);return item[2]?"@media "+item[2]+"{"+content+"}":content}).join("")},list.i=function(modules,mediaQuery){"string"==typeof modules&&(modules=[[null,modules,""]]);for(var alreadyImportedModules={},i=0;i<this.length;i++){var id=this[i][0];"number"==typeof id&&(alreadyImportedModules[id]=!0)}for(i=0;i<modules.length;i++){var item=modules[i];"number"==typeof item[0]&&alreadyImportedModules[item[0]]||(mediaQuery&&!item[2]?item[2]=mediaQuery:mediaQuery&&(item[2]="("+item[2]+") and ("+mediaQuery+")"),list.push(item))}},list}},function(module,exports,__webpack_require__){var fn,memo,stylesInDom={},isOldIE=(fn=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===memo&&(memo=fn.apply(this,arguments)),memo}),getElement=function(fn){var memo={};return function(target,parent){if("function"==typeof target)return target();if(void 0===memo[target]){var styleTarget=function(target,parent){return parent?parent.querySelector(target):document.querySelector(target)}.call(this,target,parent);if(window.HTMLIFrameElement&&styleTarget instanceof window.HTMLIFrameElement)try{styleTarget=styleTarget.contentDocument.head}catch(e){styleTarget=null}memo[target]=styleTarget}return memo[target]}}(),singleton=null,singletonCounter=0,stylesInsertedAtTop=[],fixUrls=__webpack_require__(2);function addStylesToDom(styles,options){for(var i=0;i<styles.length;i++){var item=styles[i],domStyle=stylesInDom[item.id];if(domStyle){domStyle.refs++;for(var j=0;j<domStyle.parts.length;j++)domStyle.parts[j](item.parts[j]);for(;j<item.parts.length;j++)domStyle.parts.push(addStyle(item.parts[j],options))}else{var parts=[];for(j=0;j<item.parts.length;j++)parts.push(addStyle(item.parts[j],options));stylesInDom[item.id]={id:item.id,refs:1,parts:parts}}}}function listToStyles(list,options){for(var styles=[],newStyles={},i=0;i<list.length;i++){var item=list[i],id=options.base?item[0]+options.base:item[0],part={css:item[1],media:item[2],sourceMap:item[3]};newStyles[id]?newStyles[id].parts.push(part):styles.push(newStyles[id]={id:id,parts:[part]})}return styles}function insertStyleElement(options,style){var target=getElement(options.insertInto);if(!target)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var lastStyleElementInsertedAtTop=stylesInsertedAtTop[stylesInsertedAtTop.length-1];if("top"===options.insertAt)lastStyleElementInsertedAtTop?lastStyleElementInsertedAtTop.nextSibling?target.insertBefore(style,lastStyleElementInsertedAtTop.nextSibling):target.appendChild(style):target.insertBefore(style,target.firstChild),stylesInsertedAtTop.push(style);else if("bottom"===options.insertAt)target.appendChild(style);else{if("object"!=typeof options.insertAt||!options.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var nextSibling=getElement(options.insertAt.before,target);target.insertBefore(style,nextSibling)}}function removeStyleElement(style){if(null===style.parentNode)return!1;style.parentNode.removeChild(style);var idx=stylesInsertedAtTop.indexOf(style);0<=idx&&stylesInsertedAtTop.splice(idx,1)}function createStyleElement(options){var style=document.createElement("style");if(void 0===options.attrs.type&&(options.attrs.type="text/css"),void 0===options.attrs.nonce){var nonce=function getNonce(){0;return __webpack_require__.nc}();nonce&&(options.attrs.nonce=nonce)}return addAttrs(style,options.attrs),insertStyleElement(options,style),style}function addAttrs(el,attrs){Object.keys(attrs).forEach(function(key){el.setAttribute(key,attrs[key])})}function addStyle(obj,options){var style,update,remove,result;if(options.transform&&obj.css){if(!(result="function"==typeof options.transform?options.transform(obj.css):options.transform.default(obj.css)))return function(){};obj.css=result}if(options.singleton){var styleIndex=singletonCounter++;style=singleton||(singleton=createStyleElement(options)),update=applyToSingletonTag.bind(null,style,styleIndex,!1),remove=applyToSingletonTag.bind(null,style,styleIndex,!0)}else remove=obj.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(style=function createLinkElement(options){var link=document.createElement("link");return void 0===options.attrs.type&&(options.attrs.type="text/css"),options.attrs.rel="stylesheet",addAttrs(link,options.attrs),insertStyleElement(options,link),link}(options),update=function updateLink(link,options,obj){var css=obj.css,sourceMap=obj.sourceMap,autoFixUrls=void 0===options.convertToAbsoluteUrls&&sourceMap;(options.convertToAbsoluteUrls||autoFixUrls)&&(css=fixUrls(css));sourceMap&&(css+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))+" */");var blob=new Blob([css],{type:"text/css"}),oldSrc=link.href;link.href=URL.createObjectURL(blob),oldSrc&&URL.revokeObjectURL(oldSrc)}.bind(null,style,options),function(){removeStyleElement(style),style.href&&URL.revokeObjectURL(style.href)}):(style=createStyleElement(options),update=function applyToTag(style,obj){var css=obj.css,media=obj.media;media&&style.setAttribute("media",media);if(style.styleSheet)style.styleSheet.cssText=css;else{for(;style.firstChild;)style.removeChild(style.firstChild);style.appendChild(document.createTextNode(css))}}.bind(null,style),function(){removeStyleElement(style)});return update(obj),function updateStyle(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap)return;update(obj=newObj)}else remove()}}module.exports=function(list,options){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(options=options||{}).attrs="object"==typeof options.attrs?options.attrs:{},options.singleton||"boolean"==typeof options.singleton||(options.singleton=isOldIE()),options.insertInto||(options.insertInto="head"),options.insertAt||(options.insertAt="bottom");var styles=listToStyles(list,options);return addStylesToDom(styles,options),function update(newList){for(var mayRemove=[],i=0;i<styles.length;i++){var item=styles[i];(domStyle=stylesInDom[item.id]).refs--,mayRemove.push(domStyle)}newList&&addStylesToDom(listToStyles(newList,options),options);for(i=0;i<mayRemove.length;i++){var domStyle;if(0===(domStyle=mayRemove[i]).refs){for(var j=0;j<domStyle.parts.length;j++)domStyle.parts[j]();delete stylesInDom[domStyle.id]}}}};var textStore,replaceText=(textStore=[],function(index,replacement){return textStore[index]=replacement,textStore.filter(Boolean).join("\n")});function applyToSingletonTag(style,index,remove,obj){var css=remove?"":obj.css;if(style.styleSheet)style.styleSheet.cssText=replaceText(index,css);else{var cssNode=document.createTextNode(css),childNodes=style.childNodes;childNodes[index]&&style.removeChild(childNodes[index]),childNodes.length?style.insertBefore(cssNode,childNodes[index]):style.appendChild(cssNode)}}},function(module,exports){module.exports=function(css){var location="undefined"!=typeof window&&window.location;if(!location)throw new Error("fixUrls requires window.location");if(!css||"string"!=typeof css)return css;var baseUrl=location.protocol+"//"+location.host,currentDir=baseUrl+location.pathname.replace(/\/[^\/]*$/,"/");return css.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(fullMatch,origUrl){var newUrl,unquotedOrigUrl=origUrl.trim().replace(/^"(.*)"$/,function(o,$1){return $1}).replace(/^'(.*)'$/,function(o,$1){return $1});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(unquotedOrigUrl)?fullMatch:(newUrl=0===unquotedOrigUrl.indexOf("//")?unquotedOrigUrl:0===unquotedOrigUrl.indexOf("/")?baseUrl+unquotedOrigUrl:currentDir+unquotedOrigUrl.replace(/^\.\//,""),"url("+JSON.stringify(newUrl)+")")})}},,,,,,,,,,,,,function(module,exports,__webpack_require__){module.exports=__webpack_require__(16)},function(module,exports,__webpack_require__){__webpack_require__(17),__webpack_require__(18),__webpack_require__(19),__webpack_require__(20),__webpack_require__(21),__webpack_require__(22),__webpack_require__(23)},function(module,exports){var app;window.borrowerTreeApp={},(app=window.borrowerTreeApp).App=function App(){this.run=function(recordId,recordType,canvasId){app.canvasId=canvasId;var viewModel=new app.ViewModel(recordType,canvasId);return app.viewModel=ko.mapping.fromJS(viewModel,app.contextMapping),ko.applyBindings(ko.validatedObservable(app.viewModel)),viewModel.recurseChainRetrieve(viewModel[recordType],recordId,recordType),this}},app.RelationshipSearchApp=function RelationshipSearchApp(){this.run=function(loanId){var viewModel=new app.ViewModel("RELATIONSHIP","");return app.viewModel=ko.mapping.fromJS(viewModel,app.contextMapping),app.viewModel.retrieveRecord(loanId,"LOAN"),ko.applyBindings(ko.validatedObservable(app.viewModel),document.getElementById("borrower-tree-search-account")),this}},app.LoanSearchApp=function LoanSearchApp(){this.run=function(accountId){var viewModel=new app.ViewModel("LOAN","");return app.viewModel=ko.mapping.fromJS(viewModel,app.contextMapping),app.viewModel.retrieveRecord(accountId,"RELATIONSHIP"),ko.applyBindings(ko.validatedObservable(app.viewModel)),this}},app.RelationshipSearchAppFromPackage=function RelationshipSearchAppFromPackage(){this.run=function(packageId){var viewModel=new app.ViewModel("RELATIONSHIP","");return app.viewModel=ko.mapping.fromJS(viewModel,app.contextMapping),app.viewModel.retrieveRecord(packageId,"PRODUCTPACKAGE"),ko.applyBindings(ko.validatedObservable(app.viewModel),document.getElementById("borrower-tree-search-account-pp")),this}},app.DefaultModelData={recordId:null,name:"",isLoaded:!1,isSaved:!1,disabled:!1,freeTextSearchField:""},app.objMapping={LOAN:function(rawData){return new Loan(rawData)},RELATIONSHIP:function(rawData){return new Relationship(rawData)},BORROWER:function(rawData){return new Borrower(rawData)},GUARANTOR:function(rawData){return new Guarantor(rawData)},INVOLVEMENT:function(rawData){return new Involvement(rawData)},SIGNER:function(rawData){return new Signer(rawData)},CONTACT:function(rawData){return new Contact(rawData)},PRODUCTPACKAGE:function(rawData){return new Package(rawData)}},app.contextMapping={LOAN:{create:function(options){return new Loan(options.data)}},RELATIONSHIP:{create:function(options){return new Relationship(options.data)}},BORROWER:{create:function(options){return new Borrower(options.data)}},GUARANTOR:{create:function(options){return new Guarantor(options.data)}},SIGNER:{create:function(options){return new Signer(options.data)}},CONTACT:{create:function(options){return new Contact(options.data)}},PRODUCTPACKAGE:function(options){return new Package(options.data)}},app.mapping={LOAN:{relationship:{create:function(options){return new Relationship(options.data)}},borrowers:{create:function(options){return new Borrower(options.data)}},guarantors:{create:function(options){return new Guarantor(options.data)}},productPackage:{create:function(options){return new Package(options.data)}}},PRODUCTPACKAGE:{},RELATIONSHIP:{parent:{create:function(options){return new Relationship(options.data)}},loans:{create:function(options){return new Loan(options.data)}},contacts:{create:function(options){return new Contact(options.data)}},involvements:{create:function(options){return new Involvement(options.data)}},productPackage:{create:function(options){return new Package(options.data)}}},INVOLVEMENT:{loan:{create:function(options){return new Loan(options.data)}},relationship:{create:function(options){return new Relationship(options.data)}},signers:{create:function(options){return new Signer(options.data)}},productPackage:{create:function(options){return new Package(options.data)}}},SIGNER:{involvement:{create:function(options){return"BORROWER"==LifeCycle.BorrowerTree.typeMap[options.data.apexType]?new Borrower(options.data):new Guarantor(options.data)}},contact:{create:function(options){return new Contact(options.data)}}},CONTACT:{relationship:{create:function(options){return new Relationship(options.data)}},signings:{create:function(options){return new Signer(options.data)}}}},app.mapping.BORROWER=app.mapping.INVOLVEMENT,app.mapping.GUARATOR=app.mapping.INVOLVEMENT,app.svgIcons={dollar:"M16,1.466C7.973,1.466,1.466,7.973,1.466,16c0,8.027,6.507,14.534,14.534,14.534c8.027,0,14.534-6.507,14.534-14.534C30.534,7.973,24.027,1.466,16,1.466z M17.255,23.88v2.047h-1.958v-2.024c-3.213-0.44-4.621-3.08-4.621-3.08l2.002-1.673c0,0,1.276,2.223,3.586,2.223c1.276,0,2.244-0.683,2.244-1.849c0-2.729-7.349-2.398-7.349-7.459c0-2.2,1.738-3.785,4.137-4.159V5.859h1.958v2.046c1.672,0.22,3.652,1.1,3.652,2.993v1.452h-2.596v-0.704c0-0.726-0.925-1.21-1.959-1.21c-1.32,0-2.288,0.66-2.288,1.584c0,2.794,7.349,2.112,7.349,7.415C21.413,21.614,19.785,23.506,17.255,23.88z",person:"M21.021,16.349c-0.611-1.104-1.359-1.998-2.109-2.623c-0.875,0.641-1.941,1.031-3.103,1.031c-1.164,0-2.231-0.391-3.105-1.031c-0.75,0.625-1.498,1.519-2.111,2.623c-1.422,2.563-1.578,5.192-0.35,5.874c0.55,0.307,1.127,0.078,1.723-0.496c-0.105,0.582-0.166,1.213-0.166,1.873c0,2.932,1.139,5.307,2.543,5.307c0.846,0,1.265-0.865,1.466-2.189c0.201,1.324,0.62,2.189,1.463,2.189c1.406,0,2.545-2.375,2.545-5.307c0-0.66-0.061-1.291-0.168-1.873c0.598,0.574,1.174,0.803,1.725,0.496C22.602,21.541,22.443,18.912,21.021,16.349zM15.808,13.757c2.362,0,4.278-1.916,4.278-4.279s-1.916-4.279-4.278-4.279c-2.363,0-4.28,1.916-4.28,4.279S13.445,13.757,15.808,13.757z",relationship:"M6.812,17.202l7.396-3.665v-2.164h-0.834c-0.414,0-0.808-0.084-1.167-0.237v1.159l-7.396,3.667v2.912h2V17.202zM26.561,18.875v-2.913l-7.396-3.666v-1.158c-0.358,0.152-0.753,0.236-1.166,0.236h-0.832l-0.001,2.164l7.396,3.666v1.672H26.561zM16.688,18.875v-7.501h-2v7.501H16.688zM27.875,19.875H23.25c-1.104,0-2,0.896-2,2V26.5c0,1.104,0.896,2,2,2h4.625c1.104,0,2-0.896,2-2v-4.625C29.875,20.771,28.979,19.875,27.875,19.875zM8.125,19.875H3.5c-1.104,0-2,0.896-2,2V26.5c0,1.104,0.896,2,2,2h4.625c1.104,0,2-0.896,2-2v-4.625C10.125,20.771,9.229,19.875,8.125,19.875zM13.375,10.375H18c1.104,0,2-0.896,2-2V3.75c0-1.104-0.896-2-2-2h-4.625c-1.104,0-2,0.896-2,2v4.625C11.375,9.479,12.271,10.375,13.375,10.375zM18,19.875h-4.625c-1.104,0-2,0.896-2,2V26.5c0,1.104,0.896,2,2,2H18c1.104,0,2-0.896,2-2v-4.625C20,20.771,19.104,19.875,18,19.875z",link:"M16.45,18.085l-2.47,2.471c0.054,1.023-0.297,2.062-1.078,2.846c-1.465,1.459-3.837,1.459-5.302-0.002c-1.461-1.465-1.46-3.836-0.001-5.301c0.783-0.781,1.824-1.131,2.847-1.078l2.469-2.469c-2.463-1.057-5.425-0.586-7.438,1.426c-2.634,2.637-2.636,6.907,0,9.545c2.638,2.637,6.909,2.635,9.545,0l0.001,0.002C17.033,23.511,17.506,20.548,16.45,18.085zM14.552,12.915l2.467-2.469c-0.053-1.023,0.297-2.062,1.078-2.848C19.564,6.139,21.934,6.137,23.4,7.6c1.462,1.465,1.462,3.837,0,5.301c-0.783,0.783-1.822,1.132-2.846,1.079l-2.469,2.468c2.463,1.057,5.424,0.584,7.438-1.424c2.634-2.639,2.633-6.91,0-9.546c-2.639-2.636-6.91-2.637-9.545-0.001C13.967,7.489,13.495,10.451,14.552,12.915zM18.152,10.727l-7.424,7.426c-0.585,0.584-0.587,1.535,0,2.121c0.585,0.584,1.536,0.584,2.121-0.002l7.425-7.424c0.584-0.586,0.584-1.535,0-2.121C19.687,10.141,18.736,10.142,18.152,10.727z",envelope:"M28.516,7.167H3.482l12.517,7.108L28.516,7.167zM16.74,17.303C16.51,17.434,16.255,17.5,16,17.5s-0.51-0.066-0.741-0.197L2.5,10.06v14.773h27V10.06L16.74,17.303z",outwards:"M25.545,23.328,17.918,15.623,25.534,8.007,27.391,9.864,29.649,1.436,21.222,3.694,23.058,5.53,15.455,13.134,7.942,5.543,9.809,3.696,1.393,1.394,3.608,9.833,5.456,8.005,12.98,15.608,5.465,23.123,3.609,21.268,1.351,29.695,9.779,27.438,7.941,25.6,15.443,18.098,23.057,25.791,21.19,27.638,29.606,29.939,27.393,21.5z",inwards:"M25.083,18.895l-8.428-2.259l2.258,8.428l1.838-1.837l7.053,7.053l2.476-2.476l-7.053-7.053L25.083,18.895zM5.542,11.731l8.428,2.258l-2.258-8.428L9.874,7.398L3.196,0.72L0.72,3.196l6.678,6.678L5.542,11.731zM7.589,20.935l-6.87,6.869l2.476,2.476l6.869-6.869l1.858,1.857l2.258-8.428l-8.428,2.258L7.589,20.935zM23.412,10.064l6.867-6.87l-2.476-2.476l-6.868,6.869l-1.856-1.856l-2.258,8.428l8.428-2.259L23.412,10.064z",piechart:"M15.583,15.917l1.648-10.779C16.692,5.056,16.145,5,15.583,5C9.554,5,4.666,9.888,4.666,15.917c0,6.029,4.888,10.917,10.917,10.917S26.5,21.946,26.5,15.917c0-0.256-0.021-0.507-0.038-0.759L15.583,15.917zM19.437,3.127l-1.648,10.779l10.879-0.759C28.313,8.026,24.436,3.886,19.437,3.127z",chart:"M3.625,25.062c-0.539-0.115-0.885-0.646-0.77-1.187l0,0L6.51,6.584l2.267,9.259l1.923-5.188l3.581,3.741l3.883-13.103l2.934,11.734l1.96-1.509l5.271,11.74c0.226,0.504,0,1.095-0.505,1.321l0,0c-0.505,0.227-1.096,0-1.322-0.504l0,0l-4.23-9.428l-2.374,1.826l-1.896-7.596l-2.783,9.393l-3.754-3.924L8.386,22.66l-1.731-7.083l-1.843,8.711c-0.101,0.472-0.515,0.794-0.979,0.794l0,0C3.765,25.083,3.695,25.076,3.625,25.062L3.625,25.062z",people:"M21.053,20.8c-1.132-0.453-1.584-1.698-1.584-1.698s-0.51,0.282-0.51-0.51s0.51,0.51,1.02-2.548c0,0,1.414-0.397,1.132-3.68h-0.34c0,0,0.849-3.51,0-4.699c-0.85-1.189-1.189-1.981-3.058-2.548s-1.188-0.454-2.547-0.396c-1.359,0.057-2.492,0.792-2.492,1.188c0,0-0.849,0.057-1.188,0.397c-0.34,0.34-0.906,1.924-0.906,2.321s0.283,3.058,0.566,3.624l-0.337,0.113c-0.283,3.283,1.132,3.68,1.132,3.68c0.509,3.058,1.019,1.756,1.019,2.548s-0.51,0.51-0.51,0.51s-0.452,1.245-1.584,1.698c-1.132,0.452-7.416,2.886-7.927,3.396c-0.511,0.511-0.453,2.888-0.453,2.888h26.947c0,0,0.059-2.377-0.452-2.888C28.469,23.686,22.185,21.252,21.053,20.8zM8.583,20.628c-0.099-0.18-0.148-0.31-0.148-0.31s-0.432,0.239-0.432-0.432s0.432,0.432,0.864-2.159c0,0,1.199-0.336,0.959-3.119H9.538c0,0,0.143-0.591,0.237-1.334c-0.004-0.308,0.006-0.636,0.037-0.996l0.038-0.426c-0.021-0.492-0.107-0.939-0.312-1.226C8.818,9.619,8.53,8.947,6.947,8.467c-1.583-0.48-1.008-0.385-2.159-0.336C3.636,8.179,2.676,8.802,2.676,9.139c0,0-0.72,0.048-1.008,0.336c-0.271,0.271-0.705,1.462-0.757,1.885v0.281c0.047,0.653,0.258,2.449,0.469,2.872l-0.286,0.096c-0.239,2.783,0.959,3.119,0.959,3.119c0.432,2.591,0.864,1.488,0.864,2.159s-0.432,0.432-0.432,0.432s-0.383,1.057-1.343,1.439c-0.061,0.024-0.139,0.056-0.232,0.092v5.234h0.575c-0.029-1.278,0.077-2.927,0.746-3.594C2.587,23.135,3.754,22.551,8.583,20.628zM30.913,11.572c-0.04-0.378-0.127-0.715-0.292-0.946c-0.719-1.008-1.008-1.679-2.59-2.159c-1.584-0.48-1.008-0.385-2.16-0.336C24.72,8.179,23.76,8.802,23.76,9.139c0,0-0.719,0.048-1.008,0.336c-0.271,0.272-0.709,1.472-0.758,1.891h0.033l0.08,0.913c0.02,0.231,0.022,0.436,0.027,0.645c0.09,0.666,0.21,1.35,0.33,1.589l-0.286,0.096c-0.239,2.783,0.96,3.119,0.96,3.119c0.432,2.591,0.863,1.488,0.863,2.159s-0.432,0.432-0.432,0.432s-0.053,0.142-0.163,0.338c4.77,1.9,5.927,2.48,6.279,2.834c0.67,0.667,0.775,2.315,0.746,3.594h0.48v-5.306c-0.016-0.006-0.038-0.015-0.052-0.021c-0.959-0.383-1.343-1.439-1.343-1.439s-0.433,0.239-0.433-0.432s0.433,0.432,0.864-2.159c0,0,0.804-0.229,0.963-1.841v-1.227c-0.001-0.018-0.001-0.033-0.003-0.051h-0.289c0,0,0.215-0.89,0.292-1.861V11.572z"},app.blockUI=function(){return LifeCycle.blockUI?LifeCycle.blockUI():Utils.blockUI()},app.unblockUI=function(){return LifeCycle.unblockUI?LifeCycle.unblockUI():Utils.unblockUI()},app.performingAjax=ko.observable(!1),jQuery(document).ajaxSend(function(event,request,settings){app.performingAjax(!0)}),jQuery(document).ajaxComplete(function(event,request,settings){app.performingAjax(!1)}),app.performingAjax.subscribe(function(newValue){(newValue?app.blockUI:app.unblockUI)()}),app.validate=function(model){if(null==model||!model.validationModel||model.validationModel.isValid())return model;var result=ko.validation.group(model.validationModel(),{deep:!0});throw result.showAllMessages(!0),model.disabled(!model.disabled()),model.disabled(!model.disabled()),LifeCycle.BorrowerTree.debug("ERROR","validation error for: "+model.name()),LifeCycle.BorrowerTree.debugObject("ERROR",model),LifeCycle.BorrowerTree.debugObject("ERROR",result()),"Validation Errors!"},app.mapFromJS=function(defaultData,mapping,instance){return ko.mapping.fromJS(defaultData,mapping,instance),instance.isDisabled=ko.computed(function(){return instance.validationModel&&instance.validationModel.isValid()&&instance.disabled()||!instance.validationModel&&instance.disabled()}),instance},app.mapToJS=function(model){var mapping=app.mapping[LifeCycle.BorrowerTree.typeMap[model.apexType()]],ignores=_.map(mapping,function(val,key){return key}),raw=ko.mapping.toJS(model,{ignore:ignores});return _.each(ignores,function(element,index){if(model[element])if(model[element].apexType)raw[element]=ko.mapping.toJS(app.objMapping[LifeCycle.BorrowerTree.typeMap[model[element].apexType()]]({recordId:model[element].recordId()}));else if(jQuery.isArray(model[element])){var arr=[];_.each(model[element](),function(element,index){arr[index]=app.mapToJS(element)}),raw[element]=arr}}),raw},app.errorMsg=ko.observable("")},function(module,exports){var app;app=window.borrowerTreeApp,LifeCycle.BorrowerTree||(LifeCycle.BorrowerTree={debug:!1,buffer:!0,remotingTimeout:6e4},LifeCycle.BorrowerTree.failure=function(result,event){return console.log("[BORROWER TREE ERROR: ]"),console.log(result),console.log(event),app.performingAjax(!1),jQuery("#loading-modal").modal("hide"),jQuery("body").removeClass("modal-open"),jQuery(".modal-backdrop").remove(),app.errorMsg(event.message),jQuery("#errorMessage").show().html(event.message),jQuery("#BorrowerTreeError").modal("show"),console.log("[BORROWER TREE ERROR: ]"+(event?event.message:""))},LifeCycle.BorrowerTree.debug=function(level,msg){1==LifeCycle.BorrowerTree.debug&&console.log("[BORROWER TREE "+level+"]: "+msg)},LifeCycle.BorrowerTree.debugObject=function(level,obj){1==LifeCycle.BorrowerTree.debug&&(console.log("[BORROWER TREE "+level+"]: "),console.log(obj),console.log("[------------------]"))},LifeCycle.BorrowerTree.postIncludeLoading||(LifeCycle.BorrowerTree.postIncludeLoading=function(){if(LifeCycle.BorrowerTree.remoteCallMap||(LifeCycle.BorrowerTree.remoteCallMap={LOAN:LifeCycle.BorrowerTree.retrieveLoan,RELATIONSHIP:LifeCycle.BorrowerTree.retrieveRelationship,BORROWER:LifeCycle.BorrowerTree.retrieveBorrower,GUARANTOR:LifeCycle.BorrowerTree.retrieveGuarantor,SIGNER:LifeCycle.BorrowerTree.retrieveSigner,CONTACT:LifeCycle.BorrowerTree.retrieveContact,PRODUCTPACKAGE:LifeCycle.BorrowerTree.retrievePackage}),LifeCycle.BorrowerTree.getCall||(LifeCycle.BorrowerTree.getCall=function(type){return LifeCycle.BorrowerTree.remoteCallMap[type]}),!LifeCycle.BorrowerTree.typeMap){var PREFIX=LifeCycle.Spreads&&LifeCycle.Spreads.getNamespacePrefix&&LifeCycle.Spreads.getNamespacePrefix().length?LifeCycle.Spreads.getNamespacePrefix()+".":"c.";LifeCycle.BorrowerTree.typeMap={},_.each({LifeCycleLoan:"LOAN",LifeCycleRelationship:"RELATIONSHIP",LifeCycleBorrower:"BORROWER",LifeCycleGuarantor:"GUARANTOR",LifeCycleSigner:"SIGNER",LifeCycleContact:"CONTACT",ALifeCycleInvolvement:"INVOLVEMENT",LifeCycleProductPackage:"PRODUCTPACKAGE"},function(value,key){LifeCycle.BorrowerTree.typeMap[PREFIX+key]=value})}LifeCycle.BorrowerTree.typeMapFlipped||(LifeCycle.BorrowerTree.typeMapFlipped={},_.each(LifeCycle.BorrowerTree.typeMap,function(value,key){LifeCycle.BorrowerTree.typeMapFlipped[value]=key}))}),LifeCycle.BorrowerTree._extend=function(obj){return _.each(Array.prototype.slice.call(arguments,1),function(source){if(source&&source.apexType&&source.isLoaded)for(var prop in LifeCycle.BorrowerTree.debug("INFO","DEST"),LifeCycle.BorrowerTree.debugObject("INFO",obj),LifeCycle.BorrowerTree.debug("INFO","SOURCE"),LifeCycle.BorrowerTree.debugObject("INFO",source),source)LifeCycle.BorrowerTree.debug("INFO","EXTEND KEY "+prop),jQuery.isArray(source[prop])?(LifeCycle.BorrowerTree.debug("INFO","ARRAY "+!0),obj[prop]?_.each(source[prop],function(element,index,list){LifeCycle.BorrowerTree._extend(obj[prop][index],element)}):obj[prop]=source[prop]):source[prop]&&obj[prop]&&source[prop].apexType?(LifeCycle.BorrowerTree.debug("INFO","RECURSE "+!0),LifeCycle.BorrowerTree._extend(obj[prop],source[prop])):obj[prop]=source[prop]}),LifeCycle.BorrowerTree.debug("INFO","END EXTEND"),LifeCycle.BorrowerTree.debugObject("INFO,",obj),obj},LifeCycle.BorrowerTree.remotingTemplate=function(remoteCall,objToMergeInto){var remotingArguments=[arguments[2]],success=arguments[3],failure=arguments[4],remotingOptions=arguments[5],bBlockUI=arguments[6];7<arguments.length&&(remotingArguments=Array.prototype.slice.call(arguments).slice(2,arguments.length-4),success=arguments[arguments.length-4],failure=arguments[arguments.length-3],remotingOptions=arguments[arguments.length-2],bBlockUI=arguments[arguments.length-1]),bBlockUI&&app.performingAjax(!0),LifeCycle.BorrowerTree.debug("INFO","calling ["+remoteCall+"] with arguments ["+objToMergeInto+"] and ["+JSON.stringify(remotingArguments)+"]");var callingArgs=_.toArray(arguments),defaultRemotingOptions={escape:!1,buffer:LifeCycle.BorrowerTree.buffer};_.isUndefined(remotingOptions)||_.extend(defaultRemotingOptions,remotingOptions);var actionArguments=[remoteCall,function(result,event){if(bBlockUI&&app.performingAjax(!1),event.status)success.apply(this,[result,event,objToMergeInto].concat(callingArgs));else{var failureCallback=LifeCycle.BorrowerTree.failure;jQuery.isFunction(failure)&&(failureCallback=failure),failureCallback.apply(this,[result,event,objToMergeInto].concat(callingArgs))}},defaultRemotingOptions];return[].splice.apply(actionArguments,[1,0].concat(remotingArguments)),Visualforce.remoting.Manager.invokeAction.apply(Visualforce.remoting.Manager,actionArguments)},LifeCycle.BorrowerTree.saveRecordProxy=function(model,app,callback){LifeCycle.BorrowerTree.debug("INFO","validating model: "+model.validationModel.isValid()),app.validate(model),app.performingAjax(!0);var raw=app.mapToJS(model);LifeCycle.BorrowerTree.debug("INFO","persisting model"),LifeCycle.BorrowerTree.debugObject("INFO",raw),LifeCycle.BorrowerTree.saveRecord.apply(this,[raw,function(result,event){app.performingAjax(!1),app.mapFromJS(result,app.mapping[LifeCycle.BorrowerTree.typeMap[result.apexType]],model),jQuery.isFunction(callback)&&callback.apply(this,[model,app,model])}])},ko.validation.init({decorateElement:!0,errorElementClass:"error has-error",errorMessageClass:"help-block"}))},function(module,exports){var app;app=window.borrowerTreeApp,Loan=function(data){var defaultData=_.extend({amount:0,apexType:LifeCycle.BorrowerTree.typeMapFlipped.LOAN,relationship:{},borrowers:[],guarantors:[]},app.DefaultModelData);return void 0!==data&&_.extend(defaultData,data),app.mapFromJS(defaultData,app.mapping.LOAN,this),this.show=ko.observable(!1),this.validationModel=ko.validatedObservable({}),this.selected=ko.observable(!1),this},Package=function(data){var defaultData=_.extend({apexType:LifeCycle.BorrowerTree.typeMapFlipped.PRODUCTPACKAGE},app.DefaultModelData);return void 0!==data&&_.extend(defaultData,data),app.mapFromJS(defaultData,app.mapping.PACKAGE,this),this.show=ko.observable(!1),this.validationModel=ko.validatedObservable({}),this.selected=ko.observable(!1),this},Relationship=function(data){var self=this,defaultData=_.extend({apexType:LifeCycle.BorrowerTree.typeMapFlipped.RELATIONSHIP,entityType:void 0,entityTypeLabel:void 0,isIndividual:!1,taxIdentificationNumber:"",loans:[],contacts:[],involvements:[]},app.DefaultModelData);return void 0!==data&&_.extend(defaultData,data),app.mapFromJS(defaultData,app.mapping.RELATIONSHIP,self),self.showBillingAddress=ko.observable(!1),self.showShippingAddress=ko.observable(!1),self.show=ko.observable(!1),self.selected=ko.observable(!1),self.isIndividualComputed=ko.computed(function(){return"Sole Proprietorship"==self.entityType()||"Individual"==self.entityType()},self),self.entityType.subscribe(function(newVal){_.each(self.involvements(),function(inv){_.each(inv.signers(),function(signer){signer.filterCapacityOptions(newVal)})})}),self.fireEntityTypeChange=function(){var old=self.entityType();return self.entityType(""),self.entityType(old),self},self.validationModel=ko.validatedObservable({name:self.name.extend({required:!0,minLength:3,maxLength:80}),entityType:self.entityType.extend({required:!0})}),self},Contact=function(data){var self=this,defaultData=_.extend({apexType:LifeCycle.BorrowerTree.typeMapFlipped.CONTACT,firstName:"",lastName:"",birthDate:null,ssn:"",isPrimaryContact:!1,relationship:{},signings:[]},app.DefaultModelData);return void 0!==data&&_.extend(defaultData,data),app.mapFromJS(defaultData,app.mapping.CONTACT,self),self.selected=ko.observable(!1),self.show=ko.observable(!1),self.validationModel=ko.validatedObservable({firstName:self.firstName.extend({required:{params:!0,onlyIf:function(){return""!=self.lastName()||self.selected()}},minLength:3,maxLength:80}),lastName:self.lastName.extend({required:{params:!0,onlyIf:function(){return""!=self.firstName()||self.selected()}},minLength:3,maxLength:80}),ssn:self.ssn.extend({required:!1,pattern:{message:"Invalid social security number.",params:/^([\d*]{3})\s?\-?\s?([\d*]{2})\s?\-?\s?(\d{4})$/}})}),self},Signer=function(data){var self=this,defaultData=_.extend({apexType:LifeCycle.BorrowerTree.typeMapFlipped.SIGNER,authority:"",capacity:"",ownershipPercentage:100,involvement:{},contact:{}},app.DefaultModelData);return void 0!==data&&_.extend(defaultData,data),app.mapFromJS(defaultData,app.mapping.SIGNER,self),self.show=ko.observable(!1),self.validationModel=ko.validatedObservable({ownershipPercentage:self.ownershipPercentage.extend({required:{onlyIf:function(){return self.involvement.showOwnershipPercentage()},params:!0},min:.01,max:100})}),self.filteredCapacityOptions=ko.observableArray([]),self.entityTypeObjservable=null,self.filterCapacityOptions=ko.computed({read:function(){return self.filteredCapacityOptions()},write:function(entityType){self.filteredCapacityOptions([]),_.each(self.mappedCapacityOptions[entityType]?self.mappedCapacityOptions[entityType]():[],function(element){self.filteredCapacityOptions.push(element)})}}),self.contactObservable=ko.observable(self.contact),self},Involvement=function(data){var self=this,defaultData=_.extend({contingentPercentage:null,contingentAmount:null,contingentType:"",loan:{},relationship:{},signers:[],borrowerType:"Borrower",isIncludedInGlobalAnalysis:!0,apexType:LifeCycle.BorrowerTree.typeMapFlipped.INVOLVEMENT},app.DefaultModelData);return void 0!==data&&_.extend(defaultData,data),app.mapFromJS(defaultData,app.mapping.INVOLVEMENT,self),self.show=ko.observable(!1),self.showOwnershipPercentage=ko.computed(function(){return"Assign Specific"==self.contingentType()||"Pro Rata"==self.contingentType()}),self.disableContingentAmount=ko.computed(function(){return self.contingentPercentage()||self.isDisabled()}),self.disableContingentPercentage=ko.computed(function(){return self.contingentAmount()||self.isDisabled()}),self.showOwnershipPercentage.subscribe(function(newValue){_.each(self.signers(),function(element,index,list){self.showOwnershipPercentage()?element.ownershipPercentage()||element.ownershipPercentage(100):element.ownershipPercentage(null)})}),self.validationModel=ko.validatedObservable({contingentPercentage:self.contingentPercentage.extend({required:{onlyIf:function(){return!self.contingentAmount()}},min:0,max:100}),contingentAmount:self.contingentAmount.extend({required:{onlyIf:function(){return!self.contingentPercentage()}},min:0})}),void 0!==window.borrowerTreeApp.viewModel&&void 0!==window.borrowerTreeApp.viewModel.RELATIONSHIP&&void 0!==window.borrowerTreeApp.viewModel.RELATIONSHIP.PRODUCTPACKAGE&&self.borrowerType("Related Entity"),self},Borrower=function(data){return void 0!==data&&_.extend(data,{apexType:LifeCycle.BorrowerTree.typeMapFlipped.BORROWER}),new Involvement(data)},Guarantor=function(data){return void 0!==data&&_.extend(data,{apexType:LifeCycle.BorrowerTree.typeMapFlipped.GUARANTOR}),new Involvement(data)}},function(module,exports){LifeCycle.BorrowerTree.requestNewInvolvementRecords||(LifeCycle.BorrowerTree.requestNewInvolvementRecords=function(relationship,loan){if(relationship.fireEntityTypeChange(),!relationship.involvements()||!relationship.involvements().length||relationship.involvements()[relationship.involvements().length-1].recordId()){LifeCycle.BorrowerTree.loadRelationshipContacts(relationship);var record=window.borrowerTreeApp.objMapping.BORROWER({}),raw=ko.mapping.toJS(record);LifeCycle.BorrowerTree.newRecord.apply(self,[raw,function(result,event){var record=window.borrowerTreeApp.objMapping[LifeCycle.BorrowerTree.typeMap[result.apexType]](result);(record.relationship=relationship).involvements.push(record),relationship.contacts.push(record.signers()[record.signers().length-1].contact),relationship.fireEntityTypeChange()}])}}),LifeCycle.BorrowerTree.saveNewEntity||(LifeCycle.BorrowerTree.saveNewEntity=function(urlRedirect,objectType,relationship,loanRecord,package,data,event,w){window.borrowerTreeApp.validate(relationship);var involvement=relationship.involvements()[relationship.involvements().length-1];window.borrowerTreeApp.validate(involvement);var signer=involvement.signers()[involvement.signers().length-1];window.borrowerTreeApp.validate(signer);var contacts=relationship.contacts().length?relationship.contacts():[signer.contact],contact=null;_.each(contacts,function(element,index,list){element.selected()&&(contact=element)}),null==contact&&(contact=contacts[contacts.length-1]),(relationship.isIndividualComputed()||contact.selected())&&window.borrowerTreeApp.validate(contact),relationship.isIndividualComputed()&&contact.isPrimaryContact(!0);var redirectAfterSave=function(app){w=w||window,""==urlRedirect&&"undefined"==typeof __karma__?w.location.reload():"undefined"==typeof __karma__&&(w.location=urlRedirect),app.viewModel.clear()};LifeCycle.BorrowerTree.saveRecordProxy.apply(this,[relationship,window.borrowerTreeApp,function(relationship,app,record){contact.relationship=record,involvement.relationship=record,involvement.loan=loanRecord,involvement.productPackage=loanRecord?loanRecord.productPackage:package,LifeCycle.BorrowerTree.saveRecordProxy.apply(this,[involvement,app,function(involvement,app,record){signer.involvement=record,""!=contact.firstName()||""!=contact.lastName()||""!=contact.ssn()?LifeCycle.BorrowerTree.saveRecordProxy.apply(this,[contact,app,function(contact,app,record){signer.contact=record,contact.selected()?LifeCycle.BorrowerTree.saveRecordProxy.apply(this,[signer,app,function(signer,app,record){redirectAfterSave()}]):redirectAfterSave()}]):redirectAfterSave(app)}])}])}),LifeCycle.BorrowerTree.loadRelationshipContacts||(LifeCycle.BorrowerTree.loadRelationshipContacts=function(relationship){_.each(relationship.contacts(),function(element,index,list){!element.isLoaded()&&element.recordId()&&LifeCycle.BorrowerTree.retrieveIForce.apply(self,[element,element.recordId(),function(result,event,mergeObject){relationship.contacts()[index]=window.borrowerTreeApp.objMapping[LifeCycle.BorrowerTree.typeMap[result.apexType]](result)}])})})},function(module,exports){jQuery(function(){var app;app=window.borrowerTreeApp,View=function(viewModel){var self=this,height=jQuery(window).height(),width=jQuery(window).width(),renderNode=function(r,node){var color=Raphael.getColor(),ellipse=node.shapecall(r,node).attr({fill:node.fill||color,stroke:node.stroke||color,"stroke-width":2}).dblclick(function(elem){LifeCycle.BorrowerTree.debug("INFO","dblclicking on ["+node.id+"]"),viewModel.OBJECTMAP[node.record.recordId()].show(!viewModel.OBJECTMAP[node.record.recordId()].show())}).hover(function(mouseEvent){return this.glowPath=this.glow({}),this.glowPath},function(mouseEvent){this.glowPath.remove()});return ellipse.node.id=node.label||node.id,shape=r.set().push(ellipse).push(node.iconcall(r,node)).push(node.textcall(r,node)),shape},isDone=function(){return 0!=self.counter&&self.counter==self.countercheck||(self.countercheck=self.counter,!1)},checkIfDone=function(isDoneExecuting){var b=isDoneExecuting();LifeCycle.BorrowerTree.debug("INFO","is done executing["+b+"]"),b?(self.draw(),_.each(self.toRemoveNodes,function(node){self.graph.removeNode(node.id),self.graphNodes[node.id]=null}),self.toRemoveNodes.splice(0,self.toRemoveNodes.length),app.unblockUI()):_.delay(checkIfDone,500,isDone)};return self.graphNodes={},self.toRemoveNodes=[],self.counter=0,self.counterCheck=0,self.viewModel=viewModel,self.graph=new Graph,self.layouter=null,self.renderer=null,self.render=function(){checkIfDone(isDone);var koObj=self.getInflatedObject(self.viewModel[self.viewModel.recordType()].recordId());return self.renderObj(null,self.graph,koObj,self.viewModel,self.rerender),self},self.renderObj=function(parentNode,graph,obj,vm,renderCallback){self.counter++;var edgeAdded=!1,recordType=LifeCycle.BorrowerTree.typeMap[obj.apexType()];if(null!=recordType&&recordType==self.viewModel.recordType()){if(obj.recordId()!=self.viewModel[recordType].recordId())return void self.removeNode(graph,parentNode);edgeAdded=!0}var inflatedObj=self.getInflatedObject(obj.recordId());LifeCycle.BorrowerTree.debug("INFO","rendering view for record type ["+recordType+"]["+obj.recordId()+"]");var node=self.graphNodes[obj.recordId()];switch(recordType){case"LOAN":if(null==node){node={id:obj.recordId(),content:{id:obj.recordId(),label:"Loan: \n"+inflatedObj.name()+" \nOriginal Amount: "+Utils.formatCurrencyForDisplay(inflatedObj.amount()),record:inflatedObj,iconcall:function(r,node){return r.path(app.svgIcons.dollar).attr({fill:"#000",stroke:"none"})},shapecall:function(r,node){return r.rect(0,0,200,75,4)},textcall:function(r,node){return r.text(100,25,node.label||node.id)},render:renderNode}},self.addNode(graph,node);var borrowerNode={id:obj.recordId()+"_borrowers",content:{id:obj.recordId(),label:"Borrowers",record:inflatedObj,iconcall:function(r,node){return r.path(app.svgIcons.people).attr({fill:"#000",stroke:"none",transform:["t",-17,-20]})},shapecall:function(r,node){return r.ellipse(0,0,30,20)},textcall:function(r,node){return r.text(0,30,node.label||node.id)},render:renderNode}},guarantorNode={id:obj.recordId()+"_guarantors",content:{id:obj.recordId(),label:"Guarantors",record:inflatedObj,iconcall:function(r,node){return r.path(app.svgIcons.chart).attr({fill:"#000",stroke:"none",transform:["t",-17,-20]})},shapecall:function(r,node){return r.ellipse(0,0,30,20)},textcall:function(r,node){return r.text(0,30,node.label||node.id)},render:renderNode}};self.addNode(graph,borrowerNode),self.addNode(graph,guarantorNode),self.addEdge(graph,node,borrowerNode),self.addEdge(graph,node,guarantorNode),inflatedObj.relationship&&null!=inflatedObj.relationship.recordId()&&self.renderObj(null,graph,inflatedObj.relationship,vm,renderCallback),inflatedObj.borrowers&&_.each(inflatedObj.borrowers(),function(element,index,list){self.renderObj(borrowerNode,graph,element,vm,renderCallback)}),inflatedObj.guarantors&&_.each(inflatedObj.guarantors(),function(element,index,list){self.renderObj(guarantorNode,graph,element,vm,renderCallback)})}break;case"RELATIONSHIP":null==node&&(node={id:obj.recordId(),content:{id:obj.recordId(),label:"Relationship: \n"+inflatedObj.name()+" \n("+inflatedObj.entityType()+")",record:inflatedObj,iconcall:function(r,node){return r.path(app.svgIcons.relationship).attr({fill:"#000",stroke:"none",transform:["t",-17,-20]})},shapecall:function(r,node){return r.ellipse(0,0,60,40)},textcall:function(r,node){return r.text(0,60,node.label||node.id)},render:renderNode}},self.addNode(graph,node),LifeCycle.BorrowerTree.debug("INFO","relationship has contacts: ["+inflatedObj.contacts().length+"]"),inflatedObj.parent&&self.renderObj(null,graph,inflatedObj.parent,vm,renderCallback),inflatedObj.loans&&_.each(inflatedObj.loans(),function(element,index,list){}),inflatedObj.contacts&&_.each(inflatedObj.contacts(),function(element,index,list){self.renderObj(node,graph,element,vm,renderCallback)}));break;case"BORROWER":case"GUARANTOR":if(null==node&&inflatedObj.relationship){var inflatedRelationship=self.getInflatedObject(inflatedObj.relationship.recordId());node={id:obj.recordId(),content:{id:obj.recordId(),label:inflatedRelationship.name()+" \n"+(inflatedObj.contingentType?"Contingency: "+inflatedObj.contingentType()+" ":"")+" | "+(inflatedObj.contingentPercentage?inflatedObj.contingentPercentage()+"%":""),record:inflatedObj,iconcall:function(r,node){return r.path(app.svgIcons.link).attr({fill:"#000",stroke:"none",transform:["t",-17,-15]})},shapecall:function(r,node){return r.ellipse(0,0,30,20)},textcall:function(r,node){return r.text(0,30,node.label||node.id)},render:renderNode}},self.addNode(graph,node);var relationshipNode=self.renderObj(null,graph,inflatedObj.relationship,vm,renderCallback);self.addEdge(graph,relationshipNode,node),inflatedObj.loan&&self.renderObj(node,graph,inflatedObj.loan,vm,renderCallback),inflatedObj.signers&&_.each(inflatedObj.signers(),function(element,index,list){self.renderObj(node,graph,element,vm,renderCallback)})}break;case"SIGNER":if(null==node&&(node={id:obj.recordId(),content:{id:obj.recordId(),label:"Capacity: "+inflatedObj.capacity()+" \n"+(inflatedObj.ownershipPercentage?"Ownership: "+inflatedObj.ownershipPercentage()+"%":""),record:inflatedObj}},inflatedObj.contact&&inflatedObj.involvement)){var contactNode=self.renderObj(null,graph,inflatedObj.contact,vm,renderCallback),involvementNode=self.renderObj(null,graph,inflatedObj.involvement,vm,renderCallback);edgeAdded=!0,self.addEdge(graph,involvementNode,contactNode,node.content.label)}break;case"CONTACT":null==node&&(node={id:obj.recordId(),content:{id:obj.recordId(),label:"Contact: \n"+inflatedObj.name(),record:inflatedObj,iconcall:function(r,node){return r.path(app.svgIcons.person).attr({fill:"#000",stroke:"none",transform:["t",-17,-20]})},shapecall:function(r,node){return r.ellipse(0,0,30,20)},textcall:function(r,node){return r.text(0,30,node.label||node.id)},render:renderNode}},self.addNode(graph,node),inflatedObj.relationship&&self.renderObj(null,graph,inflatedObj.relationship,vm,renderCallback),inflatedObj.signings&&_.each(inflatedObj.signings(),function(element,index,list){self.renderObj(node,graph,element,vm,renderCallback)}))}return edgeAdded||self.addEdge(graph,parentNode,node),node},self.addNode=function(graph,node){return graph.addNode(node.id,node.content),self.graphNodes[node.id]=node,LifeCycle.BorrowerTree.debug("INFO","adding node: ["+node.id+" - "+node.content.label+"]"),self},self.removeNode=function(graph,node){if(null!=graph&&null!=node)return LifeCycle.BorrowerTree.debug("INFO","removing node: ["+node.id+"]"),self.graphNodes[node.id]&&self.toRemoveNodes.push(node),self},self.addEdge=function(graph,nodeA,nodeB,label){if(null!=graph&&null!=nodeA&&null!=nodeB){LifeCycle.BorrowerTree.debug("INFO","edge label: "+label);var style={directed:!0,"stroke-width":1,"font-size":10,"font-weight":"normal"},temp={toString:function(){return""}};style.label=null!=label?label:temp,LifeCycle.BorrowerTree.debug("INFO","adding edge: ["+nodeA.id+" - "+nodeA.content.label+"] ["+nodeB.id+" - "+nodeB.content.label+"] style: ["+JSON.stringify(style)+"]"),graph.addEdge(nodeA.id,nodeB.id,style)}return self},self.getInflatedObject=function(recordId){return self.viewModel.OBJECTMAP[recordId]},self.clear=function(){self.graphNodes={},self.counter=0,self.counterCheck=0,self.graph=new Graph,self.renderer&&self.renderer.canvas.clear(),self.renderer=null,self.layouter=null},self.redraw=function(){app.blockUI(),self.clear(),self.render()},self.draw=function(){self.layouter=self.layouter||new Dracula.Layout.Spring(self.graph),self.renderer=self.renderer||new Dracula.Renderer.Raphael(self.viewModel.canvasDivId(),self.graph,width,height),self.renderer.draw(),jQuery("svg").find("text").css({"fill-opacity":1})},self},app.View=View})},function(module,exports){var app;app=window.borrowerTreeApp,ViewModel=function(type,canvasId){var self=this;return self.canvasDivId=canvasId,self.recordType=type,self[type]={},self.OBJECTMAP={},self.remoteCalls=[],self.ALLOBJECTS=[],self.SEARCHRESULTS=ko.observableArray([]),self.searched=ko.observable(!1),self.searchType=ko.observable("NONE"),self.retrieveRecord=function(objectId,objectType){var self=this,record=window.borrowerTreeApp.objMapping[objectType]({recordId:objectId});return self[self.recordType()][objectType]=ko.observable(record),LifeCycle.BorrowerTree.debug("INFO","retrieving "+objectType+" with id "+objectId),LifeCycle.BorrowerTree.retrieveIForce.apply(self,[record,record.recordId(),function(result,event,mergeObject){LifeCycle.BorrowerTree._extend(mergeObject,result);var record=window.borrowerTreeApp.objMapping[LifeCycle.BorrowerTree.typeMap[result.apexType]](result);self[self.recordType()][objectType](record)}]),self},self.createNewModel=function(model,data,event){this.clear();var t=LifeCycle.BorrowerTree.typeMap[model.apexType()],record=app.objMapping[t]({}),raw=ko.mapping.toJS(record);LifeCycle.BorrowerTree.newRecord.apply(self,[raw,function(result,event){var record=app.objMapping[LifeCycle.BorrowerTree.typeMap[result.apexType]](result);self.selectedModel(record)}])},self.selectedModel=ko.observable(),self.selectModel=function(callback,allResults,data,event){self.selectedModel(null),data.selected(!data.selected());var b=data.selected();self.deselectAll(allResults()),data.selected(b),data.selected()&&(self.selectedModel(data),callback(data))},self.clear=function(){return this.SEARCHRESULTS.removeAll(),this.selectedModel(null),this.searched(!1),this},self.deselectAll=function(list){return _.each(list,function(element,index,list){LifeCycle.BorrowerTree.debug("INFO","deselecting: "+(element.recordId?element.recordId():index)),element.selected(!1)}),self},self.searchRecords=function(){var self=this;self.clear(),self[self.recordType()];var raw=ko.mapping.toJS(self[self.recordType()]);app.performingAjax(!0),LifeCycle.BorrowerTree.searchRecords.apply(self,[raw,function(result,event){result&&result.length||(self.searched(!0),self.searchType("SIMILAR"),app.performingAjax(!1)),_.each(result,function(element,index,list){LifeCycle.BorrowerTree.debug("INFO","retrieving object"),LifeCycle.BorrowerTree.debugObject("INFO",element),LifeCycle.BorrowerTree.retrieveIForce.apply(self,[element,element.recordId,function(result,event,mergeObject){LifeCycle.BorrowerTree._extend(mergeObject,result),self.searched(!0),self.searchType("SIMILAR"),self.SEARCHRESULTS.push(app.objMapping[LifeCycle.BorrowerTree.typeMap[result.apexType]](result))},null,{buffer:!1}])}),self.SEARCHRESULTS.subscribe(function(value){value.length==result.length&&app.performingAjax(!1)})}])},self.searchRelationshipRecords=function(){var self=this;self.clear(),self[self.recordType()];var raw=ko.mapping.toJS(self.RELATIONSHIP.LOAN().productPackage);app.performingAjax(!0),LifeCycle.BorrowerTree.findDistinctRelationships.apply(self,[raw,function(result,event){result&&result.length||(self.searched(!0),self.searchType("PACKAGE"),app.performingAjax(!1)),_.each(result,function(element,index,list){LifeCycle.BorrowerTree.debug("INFO","retrieving object"),LifeCycle.BorrowerTree.debugObject("INFO",element),LifeCycle.BorrowerTree.retrieveIForce.apply(self,[element,element.recordId,function(result,event,mergeObject){LifeCycle.BorrowerTree._extend(mergeObject,result),self.searched(!0),self.searchType("PACKAGE"),self.SEARCHRESULTS.push(app.objMapping[LifeCycle.BorrowerTree.typeMap[result.apexType]](result))},null,{buffer:!1}])}),self.SEARCHRESULTS.subscribe(function(value){value.length==result.length&&app.performingAjax(!1)})}])},self.getInflatedObjects=function(objs){LifeCycle.BorrowerTree.debug("INFO","retrieving inflated objects input"),LifeCycle.BorrowerTree.debugObject("INFO",objs);var toRet=[];return _.each(objs,function(element,index,list){toRet.push(self.getInflatedObject(element.recordId()))}),LifeCycle.BorrowerTree.debug("INFO","retrieving inflated objects output"),LifeCycle.BorrowerTree.debugObject("INFO",toRet),toRet},self.getInflatedObject=function(recordId){return self.OBJECTMAP[recordId]},self.interrogateParentObjAndRetrieve=function(parentObj,result){return LifeCycle.BorrowerTree.debug("INFO","interrogateParentObjAndRetrieve object"),LifeCycle.BorrowerTree.debugObject("INFO",parentObj),_.each(result,function(value,key,object){if(LifeCycle.BorrowerTree.debug("INFO","interrogateParentObjAndRetrieve KEY: "+key),"ISLOADED"==key.toUpperCase())if(0==value){if(null==self.OBJECTMAP[object.recordId])return self.recurseChainRetrieve(parentObj,object.recordId,LifeCycle.BorrowerTree.typeMap[object.apexType]);LifeCycle.BorrowerTree.debug("INFO","found cached object: "+object.recordId),object[key]=!0}else if(!self.OBJECTMAP[object.recordId]){var rawData=ko.mapping.toJS(object),mappedObj=app.objMapping[LifeCycle.BorrowerTree.typeMap[rawData.apexType]](rawData);self.OBJECTMAP[object.recordId]=mappedObj,self.ALLOBJECTS.push(mappedObj),LifeCycle.BorrowerTree.debug("INFO","caching object: "+object.recordId)}}),!0},self.recurseChainRetrieve=function(objToMergeInto,recId,type){LifeCycle.BorrowerTree.debug("INFO","recurseChainRetrieve: recordId: ["+recId+"] type: ["+type+"]");var remoteCall=LifeCycle.BorrowerTree.getCall(type);LifeCycle.BorrowerTree.debug("INFO","recurseChainRetrieve: remoteCall found: ["+remoteCall!="null]"),self.remoteCalls.push({}),remoteCall.apply(self,[objToMergeInto,recId,function(result,event,mergeObject){try{switch(LifeCycle.BorrowerTree._extend(mergeObject,result),LifeCycle.BorrowerTree.debug("INFO","merge object: "),LifeCycle.BorrowerTree.debugObject("INFO",mergeObject),self.interrogateParentObjAndRetrieve.apply(self,[mergeObject,result]),LifeCycle.BorrowerTree.debug("INFO","apex type: "+LifeCycle.BorrowerTree.typeMap[result.apexType]),LifeCycle.BorrowerTree.typeMap[result.apexType]){case"LOAN":result.relationship&&self.interrogateParentObjAndRetrieve.apply(self,[mergeObject.relationship,result.relationship]),result.borrowers&&_.each(result.borrowers,function(element,index,list){self.interrogateParentObjAndRetrieve.apply(self,[mergeObject.borrowers[index],element])}),result.guarantors&&_.each(result.guarantors,function(element,index,list){self.interrogateParentObjAndRetrieve.apply(self,[mergeObject.guarantors[index],element])});break;case"RELATIONSHIP":result.parent&&self.interrogateParentObjAndRetrieve.apply(self,[mergeObject.parent,result.parent]),result.contacts&&_.each(result.contacts,function(element,index,list){self.interrogateParentObjAndRetrieve.apply(self,[mergeObject.contacts[index],element])});break;case"BORROWER":case"GUARANTOR":result.relationship&&self.interrogateParentObjAndRetrieve.apply(self,[mergeObject.relationship,result.relationship]),result.signers&&_.each(result.signers,function(element,index,list){self.interrogateParentObjAndRetrieve.apply(self,[mergeObject.signers[index],element])});break;case"SIGNER":result.contact&&self.interrogateParentObjAndRetrieve.apply(self,[mergeObject.contact,result.contact]),result.involvement&&self.interrogateParentObjAndRetrieve.apply(self,[mergeObject.involvement,result.involvement]);break;case"CONTACT":result.relationship&&self.interrogateParentObjAndRetrieve.apply(self,[mergeObject.relationship,result.relationship]),result.signings&&_.each(result.signings,function(element,index,list){self.interrogateParentObjAndRetrieve.apply(self,[mergeObject.signings[index],element])})}}finally{self.remoteCalls.splice(self.remoteCalls.length-1,1),0==self.remoteCalls.length&&(LifeCycle.BorrowerTree.debug("INFO","DONE WITH OBJECT"),LifeCycle.BorrowerTree.debugObject("INFO",self),ko.mapping.fromJS(self,app.contextMapping,app.viewModel),jQuery(function(){app.view=new app.View(app.viewModel).render()}))}}])},self.getPrimaryContactForRelationship=function(account){var contacts=(self.getInflatedObject(account.recordId())||account).contacts(),primaryContact=null;return _.each(contacts,function(element,index,list){var inflatedContact=self.getInflatedObject(element.recordId())||element;(inflatedContact.isPrimaryContact()||null==primaryContact)&&(primaryContact=inflatedContact)}),null==primaryContact&&(primaryContact=new Contact({})),primaryContact},self},app.ViewModel=ViewModel},function(module,exports,__webpack_require__){var content=__webpack_require__(24);"string"==typeof content&&(content=[[module.i,content,""]]);var options={hmr:!0,transform:void 0,insertInto:void 0};__webpack_require__(1)(content,options);content.locals&&(module.exports=content.locals)},function(module,exports,__webpack_require__){(module.exports=__webpack_require__(0)(!1)).push([module.i,"text{\n\tfill-opacity: 1.0;\n}\n",""])}]);