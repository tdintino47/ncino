!function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module.default}:function getModuleExports(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=19)}({19:function(module,exports,__webpack_require__){module.exports=__webpack_require__(20)},20:function(module,exports,__webpack_require__){__webpack_require__(21),__webpack_require__(22),__webpack_require__(23),__webpack_require__(24)},21:function(module,exports){function IForceUtils(app){this.app=app,this.defaultKoMappingCache={},this.defaultMappedPropertiesCache={},this.readOnlyCache={},this.propertyToTypeCache={}}function LiteForceUtils(app,utils){this.app=app,this.utils=utils}IForceUtils.prototype.getDefaultKOMappingForObject=function(obj){var type=ko.unwrap(obj.apexType);if(!type)return{};if(this.defaultKoMappingCache[type])return this.defaultKoMappingCache[type];var mapping=this.getMappingForObj(obj);if(mapping.create){var instance=mapping.create({data:{apexType:type},useViewModelPlugin:!1});if(!instance.__ko_mapping__)return{};var koMapping=instance.__ko_mapping__;return this.defaultKoMappingCache[type]=koMapping}return{}},IForceUtils.prototype.getDefaultMappedPropertiesForObject=function(obj){var type=ko.unwrap(obj.apexType);if(!type)return{};if(this.defaultMappedPropertiesCache[type])return this.defaultMappedPropertiesCache[type];var koMapping=this.getDefaultKOMappingForObject(obj);return koMapping.mappedProperties?(this.defaultMappedPropertiesCache[type]=koMapping.mappedProperties,koMapping.mappedProperties):{}},IForceUtils.prototype.getMappingForObj=function(obj){if(!obj||!ko.unwrap(obj.apexType))return null;var property=this.getPropertyForType(ko.unwrap(obj.apexType));return this.app.getMapping()[property]},IForceUtils.prototype.addKOMappings=function(mappedObj,unmappedObj){var defaultProps;mappedObj.__ko_mapping__||(mappedObj.__ko_mapping__=jQuery.extend(!0,{},this.getDefaultKOMappingForObject(mappedObj))),mappedObj.__ko_mapping__.copiedProperties||(mappedObj.__ko_mapping__.copiedProperties={}),mappedObj.__ko_mapping__.mappedProperties&&"{}"!=JSON.stringify(mappedObj.__ko_mapping__.mappedProperties)||(defaultProps=this.getDefaultMappedPropertiesForObject(mappedObj),mappedObj.__ko_mapping__.mappedProperties=jQuery.extend(!0,{},defaultProps)),mappedObj.__ko_mapping__.ignore||(mappedObj.__ko_mapping__.ignore=[]);if(mappedObj.__ko_mapping__.ignore=_.union(mappedObj.__ko_mapping__.ignore,["__changeTracking","__cached","__shallow","__height","__depth","__path","__placeholder"]),unmappedObj){var mappedProps=mappedObj.__ko_mapping__.mappedProperties;for(var unmappedProp in unmappedObj)unmappedObj.hasOwnProperty(unmappedProp)&&!mappedProps.hasOwnProperty(unmappedProp)&&(mappedProps[unmappedProp]=!0)}},IForceUtils.prototype.constructModel=function(obj,useMappingPlugin){if(!obj)return null;var useViewModelPlugin=!useMappingPlugin,mapping=this.getMappingForObj(obj);if(mapping&&mapping.create){var modelObj=mapping.create({data:obj,useViewModelPlugin:useViewModelPlugin});return this.addKOMappings(modelObj,obj),modelObj}return null},IForceUtils.prototype.constructReadOnly=function(clone){var val,mappedVal,construct={},mapped=null;for(var prop in this.readOnlyCache[clone.apexType]?mapped=this.readOnlyCache[clone.apexType]:(mapped=this.getMappingForObj(clone).create({data:{},useViewModelPlugin:!0}),this.readOnlyCache[clone.apexType]=mapped),clone){clone.hasOwnProperty(prop)&&("object"!=typeof(val=clone[prop])||null===val?construct[prop]=ko.observable(val):val instanceof Array?construct[prop]=ko.observableArray(val):construct[prop]=val)}for(var mappedProp in mapped){mapped.hasOwnProperty(mappedProp)&&!construct.hasOwnProperty(mappedProp)&&("function"!=typeof(mappedVal=mapped[mappedProp])||ko.isObservable(mappedVal)||ko.isComputed(mappedVal)?ko.isObservable(mappedVal)&&!ko.isComputed(mappedVal)&&(mappedVal()instanceof Array?mappedVal().length?construct[mappedProp]=ko.observableArray(mappedVal().slice(0)):construct[mappedProp]=ko.observableArray():construct[mappedProp]=ko.observable(mappedVal())):construct[mappedProp]=mappedVal)}return construct},IForceUtils.prototype.trackChanges=function(mappedObj){if(!mappedObj.__changeTracking){for(var prop in mappedObj){var observable;mappedObj.hasOwnProperty(prop)&&ko.isObservable(mappedObj[prop])&&-1==IForceUtils._hierarchyProperties.indexOf(prop)&&(observable=mappedObj[prop],this.addChangeTrackingToObservable(observable))}mappedObj.__changeTracking={isTrackingChanges:!1},mappedObj.__changeTracking.markClean=function(){for(var prop in mappedObj){var observable;mappedObj.hasOwnProperty(prop)&&ko.isObservable(mappedObj[prop])&&-1==IForceUtils._hierarchyProperties.indexOf(prop)&&((observable=mappedObj[prop]).__changeTracking.isDirty()&&observable.__changeTracking.markClean())}},mappedObj.__changeTracking.isDirty=function(){if(!mappedObj.__changeTracking.isTrackingChanges)return!1;for(var prop in mappedObj){if(mappedObj.hasOwnProperty(prop)&&ko.isObservable(mappedObj[prop])&&-1==IForceUtils._hierarchyProperties.indexOf(prop))if(mappedObj[prop].__changeTracking.isDirty())return!0}return!1},mappedObj.__changeTracking.isTrackingChanges=!0}},IForceUtils.prototype.addChangeTrackingToObservable=function(observable){var _this=this;observable.__changeTracking||(observable.__changeTracking={isTrackingChanges:!1,savedState:null},observable.__changeTracking.saveState=function(){observable.__changeTracking.savedState=JSON.stringify(ko.toJS(observable),function(key,value){if(!_this.isModelObject(value))return value})},observable.__changeTracking.markClean=function(){observable.__changeTracking.saveState()},observable.__changeTracking.isDirty=function(){return!!observable.__changeTracking.isTrackingChanges&&JSON.stringify(ko.toJS(observable),function(key,value){if(!_this.isModelObject(value))return value})!=observable.__changeTracking.savedState},observable.__changeTracking.saveState(),observable.__changeTracking.isTrackingChanges=!0)},IForceUtils.prototype.getIForceProvider=function(){return LifeCycle.IForceData.IForceKoNgProxy?LifeCycle.IForceData.IForceKoNgProxy:LifeCycle.Service?LifeCycle.Service:LifeCycle},IForceUtils.prototype.areObjectsMergeable=function(baseObj,mergeObj){if(!baseObj||!mergeObj)return!1;if(!ko.isObservable(baseObj.recordId))return!1;var baseObjType=baseObj.apexType(),mergeObjType=ko.unwrap(mergeObj.apexType);return this.areTypesMergeable(baseObjType,mergeObjType)},IForceUtils._inheritenceOverrides={borrower:"involvement",guarantor:"involvement",relatedEntity:"involvement",underwritingBundleTemplate:"underwritingBundle",spreadStatementTemplate:"spreadStatement"},IForceUtils.prototype.areTypesMergeable=function(type1,type2){var type1Property=this.getPropertyForType(type1),type2Property=this.getPropertyForType(type2);return IForceUtils._inheritenceOverrides[type1Property]&&(type1Property=IForceUtils._inheritenceOverrides[type1Property]),IForceUtils._inheritenceOverrides[type2Property]&&(type2Property=IForceUtils._inheritenceOverrides[type2Property]),type1Property==type2Property},IForceUtils.prototype.generateRelationshipPlaceholder=function(obj){return{apexType:ko.observable(ko.unwrap(obj.apexType)),recordId:ko.observable(ko.unwrap(obj.recordId))}},IForceUtils.prototype.generateMergeableClone=function(obj){var clone={__shallow:!0};for(var prop in obj)if(obj.hasOwnProperty(prop)){var val=obj[prop],_val=ko.unwrap(obj[prop]);if(_val&&_val.apexType&&!_val.recordId)continue;if(this.isModelObject(_val)||this.isChildrenProperty(prop,_val)){if(this.isModelObject(val))clone[prop]=this.generateRelationshipPlaceholder(val);else if(_val instanceof Array)if(this.isChildrenProperty(prop,val))clone[prop]=[];else{for(var shallowValues=[],i=0;i<_val.length;i++){var pointer=this.generateMergeableClone(_val[i]);pointer&&shallowValues.push(pointer)}clone[prop]=shallowValues}}else clone[prop]=val}return clone},IForceUtils.prototype.flattenObjects=function(jsObjs,_topLevelObjects,parentObj){var topLevelObjects=_topLevelObjects;function _topLevel(jsObj){for(var i=0;i<topLevelObjects.length;i++){var topLevelObject=topLevelObjects[i];if(_18Id(topLevelObject.recordId)==_18Id(jsObj.recordId))return topLevelObject}return null}_topLevelObjects||(topLevelObjects=[]);for(var i=0;i<jsObjs.length;i++){var jsObj=jsObjs[i];if(jsObj&&jsObj.recordId&&jsObj.apexType)if(!function _flattenObject(jsObj){for(var prop in jsObj){var val;jsObj.hasOwnProperty(prop)&&(val=jsObj[prop],this.isChildrenProperty(prop,val)&&(jsObj[prop]=[]))}}(jsObj),_topLevel(jsObj))!function _mergeObjects(target,source){for(var prop in source)source.hasOwnProperty(prop)&&(target.hasOwnProperty(prop)?"object"==typeof target[prop]?_mergeObjects(target[prop],source[prop]):!target[prop]&&source[prop]&&(target[prop]=source[prop]):target[prop]=source[prop])}(_topLevel(jsObj),jsObj);else if(topLevelObjects.push(jsObj),parentObj){var val,hasBackReference=!1;for(var prop in jsObj){!jsObj.hasOwnProperty(prop)||(val=jsObj[prop])&&"object"==typeof val&&val.recordId&&_18Id(val.recordId)==_18Id(parentObj.recordId)&&(hasBackReference=!0)}hasBackReference||(jsObj[this.getChildParentProperty(parentObj)]={recordId:parentObj.recordId,apexType:parentObj.apexType})}}return topLevelObjects},IForceUtils.prototype.isModelObject=function(obj){return!!obj&&!!this.getMappingForObj(obj)},IForceUtils.prototype.safeMerge=function(target,obj,shallow,isPrepared){if(!this.areObjectsMergeable(target,obj))throw"Tried to merge incompatible objects";if(this.isPlaceholder(obj))return target;var customMapping={},mapping=this.app.getMapping();for(var prop in mapping)mapping.hasOwnProperty(prop)&&(customMapping[prop]=mapping[prop]);customMapping=jQuery.extend(!0,{},this.app.getMapping());var mergeClone,_this=this;customMapping.update=function(arg){var mergeObj=arg.data,target=arg.target,changeObj={};for(var prop in mergeObj)if(mergeObj.hasOwnProperty(prop)){var val=mergeObj[prop],_val=ko.unwrap(val);if(void 0===_val||_.isEmpty(_val))continue;if(!(ko.unwrap(target[prop])==_val||target[prop]&&target[prop].__changeTracking&&target[prop].__changeTracking.isDirty()||"isRelationshipPointer"==prop&&!1!==_val||"isLoaded"==prop&&!0!==_val||"isSaved"==prop&&!0!==_val)){if(_this.isPlaceholder(val)&&_.isEmpty(ko.unwrap(val.recordId)))continue;_this.isModelObject(_val)||(ko.isObservable(target[prop])?changeObj[prop]=target[prop](val):changeObj[prop]=target[prop]=val)}}return changeObj},mergeClone=isPrepared?obj:shallow?this.app.mapToJS(this.generateMergeableClone(obj)):this.app.mapToJS(obj);var merged=this.app.mapFromJS(mergeClone,this.app.getMapping(),target);return this.addKOMappings(merged),merged},IForceUtils.prototype.mergeInto=function(_target,obj){var target=ko.unwrap(_target),id=obj.recordId(),lookupKey=ko.unwrap(obj.lookupKey);if(id&&_18Id(id)&&target&&"object"==typeof target){var targetObj,targetIndex=function _findInTarget(){if(target instanceof Array){for(var i=0;i<target.length;i++){var targetItem=target[i],targetId=ko.unwrap(targetItem.recordId()),targetLookupKey=ko.unwrap(targetItem.lookupKey);if(_18Id(targetId)==_18Id(id)||lookupKey==targetLookupKey&&!_.isEmpty(lookupKey))return i}return!1}return _18Id(id)}();if(!targetIndex&&0!==targetIndex||(targetObj=ko.unwrap(target)[targetIndex]),targetObj){if(targetObj==obj)return;ko.isObservable(targetObj.recordId)?this.safeMerge(targetObj,obj,!0):target[targetIndex]=obj}else target instanceof Array?(_target.push(obj),obj.hasOwnProperty("rowNumber")&&_target.sort(function(a,b){return ko.unwrap(a.rowNumber)<ko.unwrap(b.rowNumber)?-1:ko.unwrap(a.rowNumber)>ko.unwrap(b.rowNumber)?1:0})):target[_18Id(id)]=obj}},IForceUtils.prototype.willCache=function(jsObj,cacheChain,topLevelObjects){if(!(cacheChain instanceof Array&&topLevelObjects instanceof Array))return!1;if(!cacheChain.length)return!1;for(var i=0;i<topLevelObjects.length;i++){var topLevelObject=topLevelObjects[i];if(_18Id(topLevelObject.recordId)==_18Id(jsObj.recordId))return!0}return!1},IForceUtils.prototype.isPlaceholder=function(obj){if(ko.unwrap(obj.__placeholder))return!0;if(ko.unwrap(obj.isRelationshipPointer))return!0;var realProps=[];for(var prop in obj){obj.hasOwnProperty(prop)&&(0===prop.indexOf("_")||null!=ko.unwrap(obj[prop])&&realProps.push(prop))}return 2==realProps.length&&-1!=realProps.indexOf("apexType")&&-1!=realProps.indexOf("recordId")},IForceUtils.prototype.isTailObject=function(obj){return!this.hasNonEmptyChildrenProperty(obj)},IForceUtils.prototype.hasNonEmptyChildrenProperty=function(obj){if(!obj)return!1;var val,has=!1;for(var prop in obj){obj.hasOwnProperty(prop)&&(val=ko.unwrap(obj[prop]),this.isChildrenProperty(prop,val)&&val.length&&(has=!0))}return has},IForceUtils.prototype.isChildrenProperty=function(property,_value){var value=ko.unwrap(_value);if("string"!=typeof property||"object"!=typeof value||!(value instanceof Array))return!1;if(this.getTypeForProperty(property))return!0;for(var i=0;i<value.length;i++){var arrayItem=value[i];if(this.isModelObject(arrayItem))return!0}return!1},IForceUtils.prototype.getTypeForProperty=function(property){if(this.propertyToTypeCache[property])return this.propertyToTypeCache[property];if(this.app.getMapping()[property]&&this.app.getMapping()[property].create&&this.app.getMapping()[property].create({data:{},useViewModelPlugin:!0}).apexType){var type=this.app.getMapping()[property].create({data:{},useViewModelPlugin:!0}).apexType();return this.propertyToTypeCache[property]=type}return null},IForceUtils.prototype.getPropertyForType=function(type){return type=(this.app.NAMESPACE_PREFIX?this.app.NAMESPACE_PREFIX:"")+this.getApexType(type),this.app.getTypesMap()[type]},IForceUtils.prototype.getApexType=function(namespacedType){return"string"!=typeof namespacedType?null:ko.unwrap(namespacedType).substring(namespacedType.indexOf(".")+1)},IForceUtils.prototype.isType=function(object,expectedType,includeNamespace){if(!object||!object.apexType)return"undefined"==expectedType||"null"==expectedType;var type=ko.unwrap(object.apexType);return includeNamespace||(type=this.getApexType(type)),type.toLowerCase()==expectedType.toLowerCase()},IForceUtils._hierarchyProperties=["bundle","bundles","statements","statement","periods","recordTotals","recordTotal","periodTotals","records","record","recordValues","period"],IForceUtils._parentChildrenPropertyMap={spreadStatement:"statements",spreadStatementPeriod:"periods",spreadStatementRecordTotal:"recordTotals",spreadStatementPeriodTotal:"periodTotals",spreadStatementRecord:"records",spreadStatementRecordValue:"recordValues"},IForceUtils.prototype.getParentChildrenProperty=function(obj){if(!obj||!ko.unwrap(obj.apexType))return null;var property=this.getPropertyForType(ko.unwrap(obj.apexType));return IForceUtils._parentChildrenPropertyMap[property]},IForceUtils._childParentPropertyMap={underwritingBundle:"bundle",spreadStatement:"statement",spreadStatementPeriod:"period",spreadStatementRecordTotal:"recordTotal",spreadStatementPeriodTotal:"periodTotal",spreadStatementRecord:"record",spreadStatementRecordValue:"recordValue"},IForceUtils.prototype.getChildParentProperty=function(obj){if(!obj||!ko.unwrap(obj.apexType))return null;var property=this.getPropertyForType(ko.unwrap(obj.apexType)),custom=IForceUtils._childParentPropertyMap[property];return custom||property},IForceUtils._parentPropertyMap={spreadStatement:"bundle",spreadStatementPeriod:"statement",spreadStatementRecordTotal:"statement",spreadStatementPeriodTotal:"recordTotal",spreadStatementRecord:"recordTotal",spreadStatementRecordValue:"record"},IForceUtils.prototype.getParentProperty=function(obj){if(!obj||!ko.unwrap(obj.apexType))return null;var property=this.getPropertyForType(ko.unwrap(obj.apexType));return IForceUtils._parentPropertyMap[property]},IForceUtils.prototype.formatPercentageForDisplay=function(value,decimal){if(void 0===decimal&&(decimal=2),_.isUndefined(value)||isNaN(value))return"0";var iValue=(100*Math.abs(value)).toFixed(decimal);return value<0?"("+iValue+")":iValue},IForceUtils.prototype.formatETAForDisplay=function(seconds){if(isNaN(seconds))return seconds;var minutes=Math.floor(seconds/60),secondsLeftover=seconds%60,str="";return 0<minutes&&(str+=minutes.toFixed(0)+"m "),str+=secondsLeftover.toFixed(0),secondsLeftover||(str+="0"),str+="s"},IForceUtils._registerModelCatchall=function(_targetApp){if(!window.LifeCycle)throw"LifeCycle App Not Defined";var _registerModels;LifeCycle.RegistrationApp?(_registerModels=LifeCycle.RegistrationApp.registerModels,LifeCycle.RegistrationApp.registerModels=function(appId,callback){_registerModels(appId,callback);var existingAppPropertyValues={};for(var prop in _targetApp)_targetApp.hasOwnProperty(prop)&&(existingAppPropertyValues[prop]=_targetApp[prop]);var mapping,_oldVal,_newVal,existingAppMappings={};for(var mappingProp in _targetApp.mapping)_targetApp.mapping.hasOwnProperty(mappingProp)&&(existingAppMappings[mappingProp]=_targetApp.mapping[mappingProp]);function _createHandler(old){if(old.__injected)return old;function fun(options){return options?options.data&&"object"==typeof options.data?old.apply(old,arguments):ko.observable(options.data):ko.observable()}return fun.__injected=!0,IForceUtils.ORIGINAL_FUNCTION&&(fun[IForceUtils.ORIGINAL_FUNCTION]=old),fun}for(var mappingKey in callback&&callback(null,_targetApp),_targetApp.mapping){_targetApp.mapping.hasOwnProperty(mappingKey)&&("function"!=typeof(mapping=_targetApp.mapping[mappingKey]).create||mapping.create.__injected||(mapping.create=_createHandler(mapping.create)),"function"!=typeof mapping.update||mapping.update.__injected||(mapping.update=_createHandler(mapping.update)))}for(var oldProp in existingAppPropertyValues){existingAppPropertyValues.hasOwnProperty(oldProp)&&(_oldVal=existingAppPropertyValues[oldProp],_newVal=(_newVal=_targetApp[oldProp])||"",(_oldVal=_oldVal||"").toString().replace(/\s/g,"").toLowerCase()!=_newVal.toString().replace(/\s/g,"").toLowerCase()&&console.warn("IForceCache: Potential KO mapping collision. Model: this.app."+oldProp+" may be defined inconsistently"))}for(var oldMappingProp in existingAppMappings)if(existingAppMappings.hasOwnProperty(oldMappingProp)){var oldMapper,newMapper,_oldPropVal=existingAppMappings[oldMappingProp],_newPropVal=_targetApp.mapping[oldMappingProp];if(_oldPropVal instanceof Array||_newPropVal instanceof Array)continue;for(var mapperKey in _oldPropVal&&"object"==typeof _oldPropVal||(_oldPropVal={}),_newPropVal&&"object"==typeof _newPropVal||(_newPropVal={}),_oldPropVal){_oldPropVal.hasOwnProperty(mapperKey)&&(oldMapper=_oldPropVal[mapperKey],newMapper=(newMapper=_newPropVal[mapperKey])||"",(oldMapper=oldMapper||"").__original&&(oldMapper=oldMapper.__original),newMapper.__original&&(newMapper=newMapper.__original),oldMapper.toString().replace(/\s/g,"").toLowerCase()!=newMapper.toString().replace(/\s/g,"").toLowerCase()&&console.warn("IForceCache: Potential KO mapping collision. Property Mapping: '"+oldMappingProp+"': { '"+mapperKey+"': ... } may be defined inconsistently"))}}}):console.error("Can't create model registration catch-all for Cache without RegistrationApp")},"Symbol"in window&&(IForceUtils.ORIGINAL_FUNCTION=Symbol("OG Function")),LifeCycle.IForceData||(LifeCycle.IForceData={}),LifeCycle.IForceData.IForceUtils=LifeCycle.IForceData.IForceUtils||IForceUtils,LiteForceUtils.prototype.translateLiteForces=function(sObjectContainers){for(var jsForces=[],i=0;i<sObjectContainers.length;i++){var jsForce=this.mapFromDb(sObjectContainers[i]);jsForce&&jsForces.push(jsForce)}return jsForces},LiteForceUtils.prototype.mapFromDb=function(sObjectContainer){if(!sObjectContainer)return null;var sObjectType=sObjectContainer.type,apexType=this.getApexTypeForSObjectType(sObjectType);if(!apexType)return console.error("Unknown type: "+sObjectType),null;for(var objectMappingNamespace=this.getNamespace(this.getSObjectTypeForApexType(apexType)),translatedProperties=LiteForceUtils.sObjectFieldTranslations[this.stripNamespace(apexType)]||{},renameProperties=_.union(LiteForceUtils.COMMON_MAPPING._renameProperties,translatedProperties._renameProperties||[]),jsToSObjectRenames={},i=0;i<renameProperties.length;i++){var renamePair=renameProperties[i];jsToSObjectRenames[renamePair.js]=renamePair.sObject}var sObject=sObjectContainer.obj,jsForce={apexType:apexType,isRelationshipPointer:!1},strippedSObjectType=this.stripNamespace(sObjectType),relationshipExclusions=LiteForceUtils.sObjectRelationshipExclusions[strippedSObjectType],possibleProperties={};for(var field in sObject)if(sObject.hasOwnProperty(field))for(var properties=this.getJSPropertyNamesForSObjectField(field,sObjectContainer,apexType,!0),i=0;i<properties.length;i++){var property=properties[i];possibleProperties[property]=possibleProperties[property]||[],possibleProperties[property].push(field)}for(var jsPropertyName in possibleProperties)if(possibleProperties.hasOwnProperty(jsPropertyName)&&!this.shouldOmitJSProperty(apexType,jsPropertyName)){var sObjectField=void 0;if(jsToSObjectRenames[jsPropertyName])sObjectField=jsToSObjectRenames[jsPropertyName],objectMappingNamespace&&!this.getNamespace(sObjectField)&&-1!=sObjectField.indexOf("__")&&(sObjectField=objectMappingNamespace+"__"+sObjectField);else{var matches=this.getSObjectFieldNamesForJSProperty(jsPropertyName,sObjectContainer,jsForce);if(!matches.length)continue;if(1==matches.length)sObjectField=matches[0];else{for(var j=0;j<matches.length;j++){var match=matches[j];if(-1==match.indexOf("__")||this.getNamespace(match)==objectMappingNamespace){sObjectField=match;break}}if(!sObjectField)throw new Error("LiteForce Translation: Multiple sObject fields map to the JS property "+jsPropertyName+". Check the LiteForce mapping for "+apexType+" ("+sObjectType+")")}}if(!(sObjectField in sObject))continue;var id18,typeName,strippedField=this.stripNamespace(sObjectField),value=void 0;value=this.isSObjectRelationship(sObjectContainer,sObjectField)&&(!relationshipExclusions||-1==relationshipExclusions.indexOf(strippedField))&&(id18=_18Id(sObject[sObjectField]))==sObject[sObjectField]?(typeName=this.getApexTypeForSObjectRelationship(sObjectContainer,sObjectField),this.generateLiteForceRelationshipPointer(id18,typeName)):sObject[sObjectField],(jsForce[jsPropertyName]=value)&&value.isRelationshipPointer&&(!jsForce.recordId&&sObject.Id&&(jsForce.recordId=sObject.Id),this.cacheTargetToSourceRelationship(value,jsForce,jsPropertyName))}for(var k=0;k<sObjectContainer.relationshipProperties.length;k++)for(var relationshipField=sObjectContainer.relationshipProperties[k],relationshipPropertyNames=this.getJSPropertyNamesForSObjectField(relationshipField),m=0;m<relationshipPropertyNames.length;m++){var relationshipPropertyName=relationshipPropertyNames[m];jsForce[relationshipPropertyName]||(jsForce[relationshipPropertyName]=null)}for(var keepJSProperties=translatedProperties._keepJSProperties||[],k=0;k<keepJSProperties.length;k++){var keepJSProperty=keepJSProperties[k];keepJSProperty in jsForce||(jsForce[keepJSProperty]=void 0)}return this.applyFromDbTranslations(sObjectContainer,jsForce),sObject.Id&&this._cacheContainer(sObjectContainer),jsForce},LiteForceUtils.prototype.mapToDb=function(jsForce){var sObjectContainer,existingContainer=LiteForceUtils.LITEFORCE_CACHE[jsForce.recordId];existingContainer?sObjectContainer=existingContainer:(sObjectContainer={type:null,obj:{},relationshipProperties:{}}).type=this.getSObjectTypeForApexType(jsForce.apexType);var mappedProperties={},translatedProperties=this.getLiteForceMappingForApexType(jsForce.apexType);for(var jsPropertyName in jsForce)if(jsForce.hasOwnProperty(jsPropertyName)){if(-1!=LiteForceUtils.jsOnlyProperties.indexOf(jsPropertyName)||translatedProperties[jsPropertyName]&&(-1===translatedProperties._keepJSProperties.indexOf(jsPropertyName)||!translatedProperties._renameProperties.some(function(x){return x.js===jsPropertyName})))continue;var value=jsForce[jsPropertyName];if(value&&"object"==typeof value){if(!value.apexType||!value.recordId)continue;value=value.recordId}for(var sObjectFields=this.getSObjectFieldNamesForJSProperty(jsPropertyName,existingContainer,jsForce),i=0;i<sObjectFields.length;i++){var sObjectField=sObjectFields[i];if(!this.shouldOmitSObjectField(jsForce.apexType,sObjectField)){if(mappedProperties[sObjectField]&&mappedProperties[sObjectField]!=jsPropertyName)throw new Error("LiteForce Translation: Multiple JS properties map to the sObject field "+jsPropertyName+". Check the LiteForce mapping for "+jsForce.apexType);mappedProperties[sObjectField]=jsPropertyName,sObjectContainer.obj[sObjectField]=void 0===value?null:value}}}return this.applyToDbTranslations(sObjectContainer,jsForce),sObjectContainer},LiteForceUtils.prototype._cacheContainer=function(sObjectContainer){var sObject=sObjectContainer.obj,data=LiteForceUtils.LITEFORCE_CACHE[sObject.Id]||(LiteForceUtils.LITEFORCE_CACHE[sObject.Id]={obj:{},type:sObjectContainer.type,relationshipProperties:{}});_.extend(data.obj,sObject),_.extend(data.relationshipProperties,sObjectContainer.relationshipProperties)},LiteForceUtils.prototype.getLiteForceMappingForApexType=function(apexType){return LiteForceUtils.sObjectFieldTranslations[this.stripNamespace(apexType)]||{}},LiteForceUtils.prototype.hasLiteForces=function(results){return results instanceof Array&&results.length&&results[0].obj&&results[0].type},LiteForceUtils.sObjectNamespaceCache={Screen_Section__c:[],Widget__c:[]},LiteForceUtils.prototype.cacheSObjectNamespace=function(sObjectType){var namespace=this.getNamespace(sObjectType),namespaceCache=LiteForceUtils.sObjectNamespaceCache[this.stripNamespace(sObjectType)];namespaceCache?-1==namespaceCache.indexOf(namespace)&&namespaceCache.push(namespace):LiteForceUtils.sObjectNamespaceCache[this.stripNamespace(sObjectType)]=[namespace]},LiteForceUtils.apexTypeForSObjectTypeCache={},LiteForceUtils.prototype.getApexTypeForSObjectType=function(sObjectType){if(LiteForceUtils.apexTypeForSObjectTypeCache[sObjectType])return LiteForceUtils.apexTypeForSObjectTypeCache[sObjectType];this.cacheSObjectNamespace(sObjectType);var type=this.stripNamespace(sObjectType),fqSObjectTypes=[];for(var fqSObjectType in LiteForceUtils.sObjectTypeMapping)LiteForceUtils.sObjectTypeMapping.hasOwnProperty(fqSObjectType)&&this.stripNamespace(fqSObjectType)==type&&fqSObjectTypes.push(fqSObjectType);if(1<fqSObjectTypes.length&&this.stripNamespace(sObjectType)!=sObjectType&&(fqSObjectTypes[0]=fqSObjectTypes.filter(function(fqSObjectType){return fqSObjectType==sObjectType})[0]),!(apexType=apexType||LiteForceUtils.sObjectTypeMapping[fqSObjectTypes[0]]))for(var separates=(apexType=this.stripNamespace(sObjectType).split("__").shift()).split("_"),apexType="c.",i=0;i<separates.length;i++){var part=separates[i];apexType+=part.charAt(0).toUpperCase()+part.substring(1)}return LiteForceUtils.apexTypeForSObjectTypeCache[sObjectType]=apexType},LiteForceUtils.prototype.getSObjectTypeForApexType=function(apexType){for(var key in LiteForceUtils.sObjectTypeMapping){if(LiteForceUtils.sObjectTypeMapping.hasOwnProperty(key))if(LiteForceUtils.sObjectTypeMapping[key]==apexType)return key}for(var key2 in LiteForceUtils.sObjectTypeMapping)if(LiteForceUtils.sObjectTypeMapping.hasOwnProperty(key2)){var value2=LiteForceUtils.sObjectTypeMapping[key2];if(this.stripNamespace(value2)==this.stripNamespace(apexType))return key2}for(var separates=(sObjectType=this.stripNamespace(apexType)).split(/(?=[A-Z])/),sObjectType="",j=0;j<separates.length;j++){var part=separates[j];sObjectType+=part.charAt(0).toUpperCase()+part.substring(1)+"_"}return this.getNamespace(apexType)&&"c"!=this.getNamespace(apexType)&&(sObjectType=this.getNamespace(apexType)+"__"+sObjectType),sObjectType+"_c"},LiteForceUtils.prototype.getNamespacedSObjectField=function(sObject,unNamespacedFieldName){var match;if(unNamespacedFieldName in sObject)return sObject[unNamespacedFieldName];for(var field in sObject)if(sObject.hasOwnProperty(field)&&this.stripNamespace(field)==unNamespacedFieldName){if(match)throw new Error("LiteForce sObject field name collision. "+unNamespacedFieldName+" corresponds to both "+match+" and "+field+". getNamespacedSObjectField can not be used with "+unNamespacedFieldName+". Alternatively, iterate over the sObject fields explicitly");match=field}return sObject[match]},LiteForceUtils.prototype.stripNamespace=function(thingName){var existing=this.strippedNamespaceCache[thingName];if(existing)return existing;if("string"!=typeof thingName)return thingName;var fieldPieces,originalName=thingName;return-1!=thingName.indexOf("__")?3==(fieldPieces=thingName.split("__")).length&&(thingName=fieldPieces.slice(1).join("__")):-1!=thingName.indexOf(".")&&2<=(fieldPieces=thingName.split(".")).length&&(thingName=fieldPieces.slice(1).join(".")),this.strippedNamespaceCache[originalName]=thingName},LiteForceUtils.prototype.strippedNamespaceCache={},LiteForceUtils.prototype.getNamespace=function(thingName){var fieldPieces;return-1!=thingName.indexOf("__")?3==(fieldPieces=thingName.split("__")).length?fieldPieces[0]:"":-1!=thingName.indexOf(".")?2<=(fieldPieces=thingName.split(".")).length?fieldPieces[0]:"":void 0},LiteForceUtils.prototype.getFieldMatcher=function(fieldName,objectMappingNamespace){return objectMappingNamespace?fieldName:this.stripNamespace(fieldName)},LiteForceUtils.prototype.isField=function(testField,fieldName,objectMappingNamespace){return objectMappingNamespace||this.isNamespacedName(testField)?testField==fieldName:testField==this.stripNamespace(fieldName)},LiteForceUtils.prototype.getFieldMatcher=function(fieldName,mappingSObjectType){return mappingSObjectType?fieldName:this.stripNamespace(fieldName)},LiteForceUtils.getJSPropertyNamesForSObjectFieldCache={},LiteForceUtils.prototype.getJSPropertyNamesForSObjectField=function(field,sObjectContainer,apexType,disableCollisionDetect){var hash=(apexType=apexType||this.getApexTypeForSObjectType(sObjectContainer.type))+"."+field+"/"+disableCollisionDetect;if(LiteForceUtils.getJSPropertyNamesForSObjectFieldCache[hash])return LiteForceUtils.getJSPropertyNamesForSObjectFieldCache[hash];for(var objectMappingNamespace=this.getNamespace(this.getSObjectTypeForApexType(apexType)),translatedProperties=LiteForceUtils.sObjectFieldTranslations[this.stripNamespace(apexType)]||{},renameMatches=[],renameProperties=_.union(translatedProperties._renameProperties||[],LiteForceUtils.COMMON_MAPPING._renameProperties),i=0;i<renameProperties.length;i++){var renamePair=renameProperties[i],sObjectTest=renamePair.sObject;objectMappingNamespace&&!this.getNamespace(sObjectTest)&&-1!=sObjectTest.indexOf("__")&&(sObjectTest=objectMappingNamespace+"__"+sObjectTest),(disableCollisionDetect||this.stripNamespace(sObjectTest)!=this.stripNamespace(field)||this.isField(sObjectTest,field,objectMappingNamespace))&&(sObjectTest!=field&&sObjectTest!=this.getFieldMatcher(field,objectMappingNamespace)||renameMatches.push(renamePair.js))}if(renameMatches.length)return LiteForceUtils.getJSPropertyNamesForSObjectFieldCache[hash]=renameMatches;if(!disableCollisionDetect&&objectMappingNamespace&&-1!=field.indexOf("__c")&&objectMappingNamespace!=this.getNamespace(field))return LiteForceUtils.getJSPropertyNamesForSObjectFieldCache[hash]=[],[];for(var separates=(jsPropertyName=this.stripNamespace(field).split("__").shift()).split("_"),jsPropertyName="",i=0;i<separates.length;i++){var part=separates[i];jsPropertyName+=part.charAt(0).toUpperCase()+part.substring(1)}var result=[jsPropertyName.charAt(0).toLowerCase()+jsPropertyName.substring(1)];return LiteForceUtils.getJSPropertyNamesForSObjectFieldCache[hash]=result},LiteForceUtils.prototype.getSObjectFieldNamesForJSProperty=function(property,sObjectContainer,jsForce){switch(property){case"recordId":return["Id"];case"name":return["Name"]}if(sObjectContainer){var transformedNames,existingFields=[];for(var existingField in sObjectContainer.obj){sObjectContainer.obj.hasOwnProperty(existingField)&&((transformedNames=this.getJSPropertyNamesForSObjectField(existingField,sObjectContainer)).length||(transformedNames=this.getJSPropertyNamesForSObjectField(existingField,sObjectContainer,void 0,!0)),-1!=transformedNames.indexOf(property)&&existingFields.push(existingField))}if(existingFields.length)return existingFields}for(var apexType=jsForce.apexType,sObjectType=this.getSObjectTypeForApexType(apexType),translatedProperties=(this.getNamespace(sObjectType),LiteForceUtils.sObjectFieldTranslations[this.stripNamespace(apexType)]||{}),renameMatches=[],renameProperties=_.union(translatedProperties._renameProperties||[],LiteForceUtils.COMMON_MAPPING._renameProperties),i=0;i<renameProperties.length;i++){var renamePair=renameProperties[i];renamePair.js==property&&renameMatches.push(renamePair.sObject)}if(renameMatches.length)return renameMatches;for(var separates=(sObjectField=this.stripNamespace(property)).split(/(?=[A-Z])/),sObjectField="",j=0;j<separates.length;j++){var part=separates[j];sObjectField+=part.charAt(0).toUpperCase()+part.substring(1)+"_"}return[sObjectField+"_c"]},LiteForceUtils.prototype.applyFromDbTranslations=function(sObjectContainer,jsForce){var apexType=this.utils.getApexType(this.getApexTypeForSObjectType(sObjectContainer.type)),translatedProperties=LiteForceUtils.sObjectFieldTranslations[this.stripNamespace(apexType)];if(translatedProperties){for(var translatedProperty in this.addMappingUtilities(sObjectContainer.obj),translatedProperties)if(translatedProperties.hasOwnProperty(translatedProperty)&&"_deleteJSProperties"!=translatedProperty&&"_deleteSObjectFields"!=translatedProperty&&"_targetToSourceRelationships"!=translatedProperty&&"_renameProperties"!=translatedProperty&&"_keepJSProperties"!=translatedProperty&&"_keepSObjectFields"!=translatedProperty){var translator=translatedProperties[translatedProperty];if(translatedProperty.charAt(0)!=translatedProperty.toLowerCase().charAt(0))continue;if("function"!=typeof translator){console.error("SObject to JS Translator ("+translatedProperty+") must be a function");continue}jsForce[translatedProperty]=translator(sObjectContainer.obj,this)}this.removeMappingUtilities(sObjectContainer.obj)}},LiteForceUtils.prototype.applyToDbTranslations=function(sObjectContainer,jsForce){var apexType=jsForce.apexType,translatedProperties=LiteForceUtils.sObjectFieldTranslations[this.stripNamespace(apexType)];if(translatedProperties)for(var translatedProperty in translatedProperties)if(translatedProperties.hasOwnProperty(translatedProperty)&&"_deleteJSProperties"!=translatedProperty&&"_deleteSObjectFields"!=translatedProperty&&"_targetToSourceRelationships"!=translatedProperty&&"_renameProperties"!=translatedProperty&&"_keepJSProperties"!=translatedProperty&&"_keepSObjectFields"!=translatedProperty){var translator=translatedProperties[translatedProperty]||translatedProperties[this.stripNamespace(translatedProperty)];if(translatedProperty.charAt(0)!=translatedProperty.toUpperCase().charAt(0))continue;if("function"!=typeof translator){console.error("JS to SObject Translator ("+translatedProperty+") must be a function");continue}sObjectContainer.obj[translatedProperty]=translator(jsForce,this)}},LiteForceUtils.prototype.isSObjectRelationship=function(sObjectContainer,sObjectField){var relationshipName=sObjectField.replace("__c","__r");return sObjectContainer.relationshipProperties[relationshipName]},LiteForceUtils.prototype.getApexTypeForSObjectRelationship=function(sObjectContainer,sObjectField){var relationshipName=sObjectField.replace("__c","__r"),relationshipSObjectTypes=sObjectContainer.relationshipProperties[relationshipName],typeName=null;if(relationshipSObjectTypes&&relationshipSObjectTypes.length){var i=0;do{var sObjectType=relationshipSObjectTypes[i],typeName=this.getApexTypeForSObjectType(sObjectType);i++}while(!typeName&&i<relationshipSObjectTypes.length)}return typeName},LiteForceUtils.prototype.cacheTargetToSourceRelationship=function(target,source,sourceToTargetPropertyName){var targetInfo,targetToSourcePropertyName,relationship,relatedIds;target.recordId&&source.recordId&&(targetInfo=(targetInfo=LiteForceUtils.RELATIONSHIP_CACHE[target.recordId])||(LiteForceUtils.RELATIONSHIP_CACHE[target.recordId]={}),!(targetToSourcePropertyName=this.getTargetToSourcePropertyName(target.apexType,source.apexType,sourceToTargetPropertyName))||(relationship=this.getTargetToSourceRelationshipMetadata(target.apexType,targetToSourcePropertyName))&&(relatedIds=targetInfo[targetToSourcePropertyName],relationship.isOneToOne?targetInfo[targetToSourcePropertyName]=source.recordId:(Array.isArray(relatedIds)||(relatedIds=targetInfo[targetToSourcePropertyName]=[]),-1==relatedIds.indexOf(source.recordId)&&relatedIds.push(source.recordId))))},LiteForceUtils.prototype.uncacheTargetToSourceRelationship=function(target,source,sourceToTargetPropertyName){var targetInfo,targetToSourcePropertyName,relationship,relatedIds,index;target.recordId&&source.recordId&&(targetInfo=(targetInfo=LiteForceUtils.RELATIONSHIP_CACHE[target.recordId])||(LiteForceUtils.RELATIONSHIP_CACHE[target.recordId]={}),!(targetToSourcePropertyName=this.getTargetToSourcePropertyName(target.apexType,source.apexType,sourceToTargetPropertyName))||(relationship=this.getTargetToSourceRelationshipMetadata(target.apexType,targetToSourcePropertyName))&&(relatedIds=targetInfo[targetToSourcePropertyName],relationship.isOneToOne&&targetInfo[targetToSourcePropertyName]==source.recordId?targetInfo[targetToSourcePropertyName]=null:!Array.isArray(relatedIds)||-1!=(index=relatedIds.indexOf(source.recordId))&&relatedIds.splice(index,1)))},LiteForceUtils.prototype.getTargetToSourcePropertyName=function(targetApexType,sourceApexType,sourceToTargetPropertyName){var cacheHash=(targetApexType=this.stripNamespace(targetApexType))+" <- "+(sourceApexType=this.stripNamespace(sourceApexType))+"."+sourceToTargetPropertyName;if(this.targetToSourcePropertyNameCache[cacheHash])return this.targetToSourcePropertyNameCache[cacheHash];var mapping=LiteForceUtils.sObjectFieldTranslations[targetApexType];if(!mapping||!mapping._targetToSourceRelationships)return null;for(var relationships=mapping._targetToSourceRelationships,i=0;i<relationships.length;i++){var relationship=relationships[i],sourceSObjectType=relationship.sourceType;if(this.stripNamespace(this.getApexTypeForSObjectType(sourceSObjectType))==sourceApexType){var mappingSourceToTargetFieldName=relationship.sourceToTargetFieldName,mappingSourceToTargetProperties=this.getJSPropertyNamesForSObjectField(mappingSourceToTargetFieldName,null,sourceApexType);if(1==mappingSourceToTargetProperties.length&&mappingSourceToTargetProperties[0]==sourceToTargetPropertyName)this.targetToSourcePropertyNameCache[cacheHash]=relationship.targetToSourcePropertyName;else if(1<mappingSourceToTargetProperties.length){console.error("Multiple possible source-to-target relationship names found. Check mapping for "+targetApexType+": _targetToSourceRelationships: [{ targetToSourcePropertyName: "+relationship.targetToSourcePropertyName+" }]. Source type: "+sourceApexType+"."+mappingSourceToTargetProperties+" -> "+targetApexType);break}}}return this.targetToSourcePropertyNameCache[cacheHash]},LiteForceUtils.prototype.targetToSourcePropertyNameCache={},LiteForceUtils.prototype.getSourceToTargetPropertyName=function(targetApexType,sourceApexType,targetToSourcePropertyName){var cacheHash=(targetApexType=this.stripNamespace(targetApexType))+"."+targetToSourcePropertyName+" -> "+(sourceApexType=this.stripNamespace(sourceApexType));if(this.sourceToTargetPropertyNameCache[cacheHash])return this.sourceToTargetPropertyNameCache[cacheHash];var relationship=this.getTargetToSourceRelationshipMetadata(targetApexType,targetToSourcePropertyName);if(!relationship)return null;var sourceToTargetFieldName=relationship.sourceToTargetFieldName,mappingSourceToTargetProperty=this.getJSPropertyNamesForSObjectField(sourceToTargetFieldName,null,sourceApexType);return 1!=mappingSourceToTargetProperty.length?(1<mappingSourceToTargetProperty.length&&console.error("Multiple possible source-to-target relationship names found. Check mapping for "+targetApexType+": _targetToSourceRelationships: [{ targetToSourcePropertyName: "+relationship.targetToSourcePropertyName+" }]. Source type: "+sourceApexType+"."+mappingSourceToTargetProperty+" -> "+targetApexType),null):(this.sourceToTargetPropertyNameCache[cacheHash]=mappingSourceToTargetProperty[0],this.sourceToTargetPropertyNameCache[cacheHash])},LiteForceUtils.prototype.sourceToTargetPropertyNameCache={},LiteForceUtils.prototype.getAllTargetToSourceRelationshipMetadata=function(targetApexType){if(targetApexType=this.stripNamespace(targetApexType),this.targetToSourceRelationshipMetadataCache[targetApexType])return this.targetToSourceRelationshipMetadataCache[targetApexType];var mapping=LiteForceUtils.sObjectFieldTranslations[targetApexType];if(!mapping||!mapping._targetToSourceRelationships)return null;this.targetToSourceRelationshipMetadataCache[targetApexType]=this.targetToSourceRelationshipMetadataCache[targetApexType]||{};for(var relationships=mapping._targetToSourceRelationships,i=0;i<relationships.length;i++){var relationship=relationships[i];this.targetToSourceRelationshipMetadataCache[targetApexType][relationship.targetToSourcePropertyName]=relationship}return this.targetToSourceRelationshipMetadataCache[targetApexType]},LiteForceUtils.prototype.targetToSourceRelationshipMetadataCache={},LiteForceUtils.prototype.getTargetToSourceRelationshipMetadata=function(targetApexType,relationshipPropertyName){var relationships=this.getAllTargetToSourceRelationshipMetadata(targetApexType);if(relationships)return relationships[relationshipPropertyName]},LiteForceUtils.prototype.generateLiteForceRelationshipPointer=function(id18,typeName){return{apexType:typeName,recordId:id18,isRelationshipPointer:!0}},LiteForceUtils.prototype.shouldOmitJSProperty=function(apexType,jsPropertyName){var translatedProperties=LiteForceUtils.sObjectFieldTranslations[this.stripNamespace(apexType)];if(!translatedProperties)return!1;var deleteProperties=_.union(translatedProperties._deleteJSProperties||[],LiteForceUtils.COMMON_MAPPING._deleteJSProperties),keepProperties=_.union(translatedProperties._keepJSProperties||[],LiteForceUtils.COMMON_MAPPING._keepJSProperties);return-1!=deleteProperties.indexOf(jsPropertyName)||translatedProperties._keepJSProperties instanceof Array&&-1==keepProperties.indexOf(jsPropertyName)},LiteForceUtils.prototype.shouldOmitSObjectField=function(apexType,sObjectFieldName){var translatedProperties=LiteForceUtils.sObjectFieldTranslations[this.stripNamespace(apexType)];if(!translatedProperties)return!1;var deleteProperties=_.union(translatedProperties._deleteSObjectFields||[],LiteForceUtils.COMMON_MAPPING._deleteSObjectFields),keepProperties=_.union(translatedProperties._keepSObjectFields||[],LiteForceUtils.COMMON_MAPPING._keepSObjectFields);return-1!=deleteProperties.indexOf(sObjectFieldName)||translatedProperties._keepSObjectFields instanceof Array&&-1==keepProperties.indexOf(sObjectFieldName)},LiteForceUtils.prototype.addMappingUtilities=function(sObject){var _this=this;sObject.get=function(field){return _this.getNamespacedSObjectField(sObject,field)}},LiteForceUtils.prototype.removeMappingUtilities=function(sObject){delete sObject.get},LiteForceUtils.prototype.isNamespacedName=function(name){return-1==name.indexOf("__c")||name!=this.stripNamespace(name)},LiteForceUtils.prototype.areAllFieldsNamespaced=function(sObject){for(var field in sObject)if(sObject.hasOwnProperty(field)&&!this.isNamespacedName(field))return!1;return!0},LiteForceUtils.prototype.isObjectAndFieldsFullyNamespaced=function(sObjectContainer){return this.isNamespacedName(sObjectContainer.type)&&this.areAllFieldsNamespaced(sObjectContainer.obj)},LiteForceUtils.prototype.getCurrentTypedFieldList=function(namespace){for(var typeMappings=LiteForceUtils.sObjectTypeMapping,sObjectTypes=Object.keys(typeMappings),typedList={},i=0;i<sObjectTypes.length;i++){var sObjectType=sObjectTypes[i],apexType=typeMappings[sObjectType],mapping=this.getLiteForceMappingForApexType(apexType);if(mapping&&mapping._keepJSProperties){var fields=["Id","Name"],jsForce={apexType:apexType,recordId:null,name:null};sObjectContainer={type:apexType,obj:jsForce,relationshipProperties:{}};for(var conjoinedPropertyList=mapping._keepJSProperties.concat(LiteForceUtils.COMMON_MAPPING._keepJSProperties),j=0;j<conjoinedPropertyList.length;j++)this.getSObjectFieldNamesForJSProperty(conjoinedPropertyList[j],sObjectContainer,jsForce).forEach(function(fieldName){fields.push(fieldName)});(mapping._keepSObjectFields||[]).forEach(function(property){fields.push(property)}),namespace&&-1!==sObjectType.indexOf("__c")&&!this.getNamespace(sObjectType)&&(sObjectType=namespace+"__"+sObjectType),typedList[sObjectType]=fields}}return typedList},LiteForceUtils.LITEFORCE_CACHE={},LiteForceUtils.RELATIONSHIP_CACHE={},LiteForceUtils.jsOnlyProperties=["apexType","isRelationshipPointer","lastModifiedDate"],LiteForceUtils.COMMON_MAPPING={_renameProperties:[{sObject:"Id",js:"recordId"},{sObject:"lookupKey__c",js:"lookupKey"},{sObject:"CreatedById",js:"createdById"},{sObject:"CreatedDate",js:"createdDate"},{sObject:"CurrencyIsoCode",js:"currencyIsoCode"},{sObject:"IsDeleted",js:"isDeleted"},{sObject:"LastModifiedById",js:"lastModifiedById"},{sObject:"LastModifiedDate",js:"lastModifiedDate"},{sObject:"LastReferencedDate",js:"lastReferencedDate"},{sObject:"LastViewedDate",js:"lastViewedDate"},{sObject:"OwnerId",js:"ownerId"},{sObject:"SystemModstamp",js:"systemModstamp"}],_deleteSObjectFields:["CreatedById","CreatedDate","IsDeleted","LastModifiedById","LastModifiedDate","LastReferencedDate","LastViewedDate","OwnerId","SystemModstamp","Disabled__c","Is_Loaded__c","Is_Saved__c","Is_L_L_C_B_I__c","Id__c","Saved__c","__placeholder__c"],_keepSObjectFields:["Id","Name"],_keepJSProperties:["apexType","currencyIsoCode","name","lookupKey","recordId","isRelationshipPointer","lastModifiedDate"]},LiteForceUtils.sObjectTypeMapping={Account:"c.LifeCycleAccount",nFORCE__Screen_Section__c:"c.LifeCycleScreenSection",nFORCE__Widget__c:"c.LifeCycleWidget"},LiteForceUtils.sObjectRelationshipExclusions={Spread_Statement_Period__c:["Analyst__c","Statement_Id__c"]},LiteForceUtils.sObjectFieldTranslations={CovenantMgmt:{_renameProperties:[{sObject:"Next_Evaluation_Date__c",js:"nextEvalDate"}]}},LifeCycle.IForceData||(LifeCycle.IForceData={}),LifeCycle.IForceData.LiteForceUtils=LifeCycle.IForceData.LiteForceUtils||LiteForceUtils},22:function(module,exports){!function(){LifeCycle.IForceData||(LifeCycle.IForceData={});function IForceCache(_optionalMappingApp,_privateContext){var self=this;function _recordServiceTemplate(serviceFunction,userOptions,callback){var options={objectToMergeInto:{},recordId:void 0,recordIds:void 0,additionalArguments:[],successFunction:function(){},failureFunction:function(){},loaderOptions:{},remotingOptions:{},blockUI:!1};if(userOptions&&_.extend(options,userOptions),options.recordIds){if(!(options.recordIds instanceof Array))throw new Error("IForce Service Loader: options.recordIds must be an array");_.each(options.recordIds,function(recordId){if(""===_18Id(recordId))throw"IForce Service Loader: All options.recordIds must be valid SFDC Ids, Invalid: "+recordId})}else if(""===_18Id(options.recordId))throw new Error("IForce Service Loader: options.recordId must be valid SFDC Id, Invalid: "+options.recordId);if(options.recordId)return options.successFunction=function(results){if(options.expectResult&&(!results||results instanceof Array&&0===results.length))throw"IForce Loader: IForce Provider returned null result for: "+options.recordId;(results instanceof Array&&results[0].isLLCBI||results.isLLCBI)&&(options.loaderOptions.iForceProvider=LifeCycle),self._liteForceUtils.hasLiteForces(results)&&(results=self._liteForceUtils.translateLiteForces(results)),self._cacheUnmappedIForces([results],callback,options.loaderOptions)},_serviceCallTemplate(serviceFunction,options.recordId,options);var ids=options.recordIds,numQueues=Math.max(1,Math.ceil(self._concurrencyAvailable()/self._recordBatchChunkSize)),queueSize=Math.ceil(ids.length/numQueues),chunkSize=self._recordBatchChunkSize;options.loaderOptions.iForceProvider==LifeCycle.LiteForceService&&(numQueues=Math.min(Math.ceil(ids.length/self._liteRecordBatchChunkSize),Math.ceil(self._liteConcurrencyAvailable()/self._liteRecordBatchChunkSize)),queueSize=Math.ceil(ids.length/numQueues),chunkSize=self._liteRecordBatchChunkSize);var batch={id:++self._stats.batchCount,requestIds:ids,queues:[],cachedResults:ko.observableArray(),batchSuccess:callback,batchFailure:options.failureFunction,batchStart:new Date,batchEnd:null,flightTime:0,inProgress:function(){for(var i=0;i<batch.queues.length;i++){if(batch.queues[i].inProgress)return!0}return!1}};self._batches.push(batch);for(var i=0;i<numQueues;i++){var start=i*queueSize,end=start+queueSize,queue={id:i,batch:batch,inProgress:!0,allQueueIds:ids.slice(start,end),queueIds:ids.slice(start,end),results:ko.observableArray(),cachedResults:ko.observableArray(),chunkFailures:0,maxChunkRetries:5,retryDelay:self._batchRetryDelay,chunkSize:chunkSize,queueStart:new Date,queueEnd:null,status:QUEUE_STATUS.PENDING};queue.allQueueIds.length&&(batch.queues.push(queue),_recordServiceTemplateBatch(batch,queue,serviceFunction,options))}_printBatches()}_privateContext=_privateContext||{},self.defaultIForceProvider=null,self.getIForceById=function(id15Or18,userOptions,callback){var result=self.getIForcesById([id15Or18],userOptions,function(all){if(callback&&all instanceof Array){if(1!=all.length)throw"getIForceById: single IForce requested, but "+all.length+" were provided";callback(all[0])}});if(result instanceof Array){if(1==result.length)return result[0];throw"getIForceById: single IForce requested, but "+result.length+" were provided"}},self.getIForcesById=function(ids15Or18,userOptions,callback){var options={wait:!1,alwaysLoadNewer:!1};userOptions&&_.extend(options,userOptions),options.recordIds=ids15Or18;for(var _pendingChanged,changeSubscription,unavailableIds=[],availableIForces=[],placeholders=[],i=0;i<options.recordIds.length;i++){var requestedId=options.recordIds[i],existingIForce=self.lookupIForceById(requestedId,options);existingIForce&&!_utils.isPlaceholder(existingIForce)?availableIForces.push(existingIForce):(existingIForce&&placeholders.push(existingIForce),unavailableIds.push(_18Id(requestedId)))}function _loadedRemaining(iForces){if(!(iForces instanceof Array))throw"getIForcesById: Did not receive iForce array from loader";for(var i=0;i<iForces.length;i++)availableIForces.push(iForces[i]);return callback&&callback(availableIForces),availableIForces}if(0===unavailableIds.length){if(!options.alwaysLoadNewer)return _loadedRemaining([]);pendingRequests().length?(_pendingChanged=function(newArray){newArray.length||(changeSubscription&&changeSubscription.dispose(),self.loadIForcesById(options.recordIds,options,_loadedRemaining))},changeSubscription=pendingRequests.subscribe(_pendingChanged)):self.loadIForcesById(options.recordIds,options,_loadedRemaining)}else if(options.wait){_app.log("Pending on ["+unavailableIds+"]");function _loadSubscription(iForce){_app.log("iForce "+iForce.recordId()+" is now ready");var unavailableIndex=unavailableIds.indexOf(iForce.recordId());unavailableIds.splice(unavailableIndex,1),-1==availableIForces.indexOf(iForce)&&availableIForces.push(iForce),unavailableIds.length||(_app.log("All requested iForces loaded"),_loadedRemaining([]))}for(var j=0;j<unavailableIds.length;j++){var unavailableId=unavailableIds[j];IdSubscription.create(unavailableId,this,_loadSubscription)}}else options.alwaysLoadNewer||(options.recordIds=unavailableIds),self.loadIForcesById(options.recordIds,options,_loadedRemaining);if(placeholders.length&&options.alwaysReturnModel)return _loadedRemaining(placeholders)},self.loadIForceById=function(id15Or18,userOptions,callback){self.loadIForcesById([id15Or18],userOptions,function(all){if(callback&&all instanceof Array){if(1!=all.length)throw"loadIForceById: single IForce requested, but "+all.length+" were provided";callback(all[0])}})},self.loadIForcesById=function(ids15Or18,userOptions,callback){var options={iForceProvider:self.defaultIForceProvider||_utils.getIForceProvider(),useLiteForces:self.useLiteForces};userOptions&&_.extend(options,userOptions),options.recordIds=ids15Or18,"function"==typeof options.iForceProvider&&(options.iForceProvider=options.iForceProvider());for(var iForceIdsToLoad=_trimPendingRequests(options.recordIds),trimmedRequests=_.difference(options.recordIds,iForceIdsToLoad),allIForces=[],i=0;i<trimmedRequests.length;i++){var trimmedId=trimmedRequests[i];IdSubscription.create(trimmedId,this,_pendingLoaded)}function _pendingLoaded(iForce){allIForces.push(iForce);var index=trimmedRequests.indexOf(iForce.recordId());trimmedRequests.splice(index,1),!callback||iForceIdsToLoad.length||trimmedRequests.length||callback(allIForces)}function _nonTrimmedLoaded(iForces){allIForces.push.apply(allIForces,iForces),iForceIdsToLoad=[],callback&&!trimmedRequests.length&&callback(allIForces)}if(iForceIdsToLoad.length)return _addPendingRequests(iForceIdsToLoad),"function"==typeof options.iForceProvider.retrieveIForcesLean?self._iForceServiceTemplate(options.iForceProvider.retrieveIForcesLean,{objectToMergeInto:[],recordIds:iForceIdsToLoad,loaderOptions:options},_nonTrimmedLoaded):1<iForceIdsToLoad.length?self._iForceServiceTemplate(options.iForceProvider.retrieveIForces,{objectToMergeInto:[],recordIds:iForceIdsToLoad,loaderOptions:options},_nonTrimmedLoaded):self._iForceServiceTemplate(options.iForceProvider.retrieveIForce,{objectToMergeInto:[],recordId:iForceIdsToLoad[0],loaderOptions:options},_nonTrimmedLoaded)},self.lookupIForceById=function(id15Or18,userOptions){var options={includeNamespace:!1,generatePlaceholder:!1,placeholderType:null,alwaysReturnModel:!1};userOptions&&_.extend(options,userOptions);var includeNamespace=options.includeNamespace,expectedTypes=options.expectedTypes;if("string"==typeof options.expectedType)expectedTypes=[options.expectedType];else if(expectedTypes&&!(expectedTypes instanceof Array))return null;if(_15Id(id15Or18)!=id15Or18&&_18Id(id15Or18)!=id15Or18)return options.generatePlaceholder&&options.placeholderType&&options.alwaysReturnModel?_utils.constructModel({recordId:_18Id(id15Or18),apexType:options.placeholderType}):null;var match=_iForceMap[_18Id(id15Or18)];if(void 0===match)return options.generatePlaceholder&&options.placeholderType?_cacheObject({__placeholder:!0,recordId:_18Id(id15Or18),apexType:options.placeholderType},[],null,userOptions):null;if(match&&expectedTypes){for(var t=0;t<expectedTypes.length;t++){var expectedType=expectedTypes[t];if(_utils.isType(match,expectedType,includeNamespace))return match}return null}return match},self.lookupIForcesByName=function(name,userOptions){var options={caseSensitive:!1,nameProperty:"name"};return userOptions&&_.extend(options,userOptions),self.lookupIForcesByProperty(options.nameProperty,name,options)},self.lookupIForcesByProperty=function(property,value,userOptions){var options={caseSensitive:!1,property:property};return userOptions&&_.extend(options,userOptions),self.lookupIForcesByFilter(function _each(obj){if(options.caseSensitive||"string"!=typeof ko.unwrap(obj[options.property])){if(ko.unwrap(obj[options.property])!=value)return!1}else if(ko.unwrap(obj[options.property]).toLowerCase()!=value.toLowerCase())return!1;return!options.filter||options.filter(obj)},options)},self.lookupIForcesByFilter=function(filter,userOptions){var matches=[];if(!filter)return[];var options={filter:filter};function _each(obj){try{options.filter(obj)&&matches.push(obj)}catch(e){console.error("IForce Lookup Filter Error: "+e.toString())}}if(userOptions&&(_.extend(options,userOptions),userOptions.filter&&(options.filter=function(x){return filter(x)&&userOptions.filter(x)})),options.array)for(var i=0;i<options.array.length;i++)_each(options.array[i]);else for(var prop in _iForceMap)_iForceMap.hasOwnProperty(prop)&&_each(_iForceMap[prop]);return matches},self.isCached=function(obj){if(!obj)return!1;var id=ko.unwrap(obj.recordId);return!!id&&!!self.lookupIForceById(id)},self._iForceTypedIdMapServiceTemplate=function(serviceFunction,userOptions,callback){var options={recordId:void 0,additionalArguments:[],failureFunction:function(){},expectResult:!0,alwaysLoadNewer:!1};return userOptions&&_.extend(options,userOptions),options.successFunction=function(results){if(options.expectResult&&(!results||results instanceof Array&&0===results.length))throw"IForce Id Loader: IForce Provider returned null result for: "+options.recordId;var allIds=[];for(var type in results)if(results.hasOwnProperty(type))for(var typeIds=results[type],i=0;i<typeIds.length;i++){var typeId=typeIds[i];-1==allIds.indexOf(typeId)&&allIds.push(typeId)}options.alwaysLoadNewer?self.loadIForcesById(allIds,options,callback):self.getIForcesById(allIds,options,callback)},_serviceCallTemplate(serviceFunction,options.recordId,options)},self._iForceIdServiceTemplate=function(serviceFunction,userOptions,callback){var options={recordId:void 0,additionalArguments:[],failureFunction:function(){},expectResult:!0,alwaysLoadNewer:!1};return userOptions&&_.extend(options,userOptions),options.successFunction=function(results){if(options.expectResult&&(!results||results instanceof Array&&0===results.length))throw"IForce Id Loader: IForce Provider returned null result for: "+options.recordId;options.alwaysLoadNewer?self.loadIForcesById(results,options,callback):self.getIForcesById(results,options,callback)},_serviceCallTemplate(serviceFunction,options.recordId,options)},self._iForceServiceTemplate=function(serviceFunction,userOptions,callback){var options={recordId:void 0,recordIds:void 0,additionalArguments:[],failureFunction:function(){},loaderOptions:{},expectResult:!0};return userOptions&&_.extend(options,userOptions),options.successFunction=function(results){if(options.expectResult&&(!results||results instanceof Array&&0===results.length))throw"IForce Loader: IForce Provider returned null result for: "+options.recordId;(results instanceof Array&&results[0].isLLCBI||results.isLLCBI)&&(options.loaderOptions.iForceProvider=LifeCycle),self._liteForceUtils.hasLiteForces(results)&&(results=self._liteForceUtils.translateLiteForces(results)),results instanceof Array?self._cacheUnmappedIForces(results,callback,options.loaderOptions):self._cacheUnmappedIForces([results],callback,options.loaderOptions)},_recordServiceTemplate(serviceFunction,options,callback)},_privateContext._recordServiceTemplate=_recordServiceTemplate;var QUEUE_STATUS={PENDING:"Pending",RATELIMITED:"Rate-Limited",REQUEST:"In-Flight",FAILSAFE:"Failed, Waiting",RETRY:"Failed, Retrying",CACHING:"Caching",DONE:"",FAILED:"X, Fatal Error"};function _printBatches(){self._app.debug&&(console.log(""),console.log("========================================="),_.each(self._batches().sort(function(a,b){return!b.inProgress()}),function(batch){var bStr="Batch #"+batch.id+"  ";batch.inProgress()?(bStr+="("+batch.cachedResults().length+"/"+batch.requestIds.length+")",console.group(bStr),_.each(batch.queues,function(queue){if(queue.status!=QUEUE_STATUS.DONE){var qStr="Queue "+queue.id+": ";switch(qStr+=queue.status+" - "+Math.round(queue.results().length/queue.allQueueIds.length*100)+"% ("+queue.results().length+"/"+queue.allQueueIds.length+") Chunk Size: "+queue.chunkSize,queue.status){case QUEUE_STATUS.FAILSAFE:case QUEUE_STATUS.FAILED:case QUEUE_STATUS.RETRY:console.error(qStr);break;case QUEUE_STATUS.RATELIMITED:case QUEUE_STATUS.PENDING:console.warn(qStr);break;case QUEUE_STATUS.CACHING:case QUEUE_STATUS.DONE:console.debug(qStr);break;default:console.log(qStr)}}}),console.groupEnd()):(bStr+="  ",console.log(bStr))}))}function _recordServiceTemplateBatch(batch,queue,serviceFunction,userOptions){var options={objectToMergeInto:{},recordId:void 0,recordIds:void 0,additionalArguments:[],successFunction:function(){},failureFunction:function(){},remotingOptions:{},blockUI:!1};userOptions&&_.extend(options,userOptions);var concurrencyAvailable=self._concurrencyAvailable,recordBatchChunkSize=self._recordBatchChunkSize,maxConcurrentRecords=self._maxConcurrentRecords;options.loaderOptions.iForceProvider==LifeCycle.LiteForceService&&(concurrencyAvailable=self._liteConcurrencyAvailable,recordBatchChunkSize=self._liteRecordBatchChunkSize,maxConcurrentRecords=self._liteMaxConcurrentRecords);var chunkSize=queue.chunkSize,chunk=queue.queueIds.slice(0,chunkSize),actualChunkSize=chunk.length,isWaiting=ko.observable(!0);function _execute(){_printBatches();var chunkStart=Date.now();return options.successFunction=function chunkSuccess(results){if(batch.flightTime+=Date.now()-chunkStart,queue.status=QUEUE_STATUS.REQUEST,queue.queueIds.splice(0,chunkSize),concurrencyAvailable(concurrencyAvailable()+actualChunkSize),5==queue.maxChunkRetries&&(queue.chunkSize=Math.min(recordBatchChunkSize,Math.ceil(2*actualChunkSize))),queue.maxChunkRetries=Math.min(5,queue.maxChunkRetries+1),queue.results.push.apply(queue.results,results),options.expectResult&&(!results||results instanceof Array&&0===results.length))throw"IForce Loader: IForce Provider returned null result for: "+options.recordId;(results instanceof Array&&results[0].isLLCBI||results.isLLCBI)&&(options.iForceProvider=LifeCycle),queue.queueIds.length&&batch.inProgress()&&queue.inProgress&&_recordServiceTemplateBatch(batch,queue,serviceFunction,options),queue.queueIds.length||(queue.status=QUEUE_STATUS.CACHING),_printBatches(),options.loaderOptions||(options.loaderOptions={}),self._liteForceUtils.hasLiteForces(results)&&(results=self._liteForceUtils.translateLiteForces(results)),options.loaderOptions.cacheAsync=!1,options.loaderOptions.deferNotifications=!0,self._cacheUnmappedIForces(results,function(iForces){if(queue.cachedResults.push.apply(queue.cachedResults,iForces),_printBatches(),queue.cachedResults().length==queue.allQueueIds.length){var existing=_.find(queue.cachedResults(),function(x){for(var existing=[],i=0;i<iForces.length;i++){var iForce=iForces[i];x.recordId()==iForce.recordId()&&existing.push(x)}return existing});if(batch.cachedResults.removeAll(existing),batch.cachedResults.push.apply(batch.cachedResults,queue.cachedResults()),queue.inProgress=!1,queue.queueEnd=new Date,queue.status=QUEUE_STATUS.DONE,_printBatches(),!batch.inProgress()){_printBatches(),batch.batchEnd=new Date,batch.batchSuccess(batch.cachedResults(),null);for(var i=0;i<batch.cachedResults().length;i++){_notifyAndRemoveSubscribers(batch.cachedResults()[i])}}}},options.loaderOptions)},options.failureFunction=function chunkFailure(result,event){queue.chunkFailures<queue.maxChunkRetries?(queue.status=QUEUE_STATUS.FAILSAFE,console.warn("(#"+batch.id+": "+batch.requestIds.length+") - Batch Request: Attempting to recover from error, requeuing chunk and reducing chunk size"),queue.chunkFailures++,queue.chunkSize=Math.max(1,Math.floor(Math.sqrt(actualChunkSize))),setTimeout(function(){queue.status=QUEUE_STATUS.RETRY,concurrencyAvailable(Math.min(concurrencyAvailable()+actualChunkSize,maxConcurrentRecords)),batch.inProgress()&&queue.inProgress&&_recordServiceTemplateBatch(batch,queue,serviceFunction,options)},queue.retryDelay)):(queue.status=QUEUE_STATUS.FAILED,concurrencyAvailable(Math.min(concurrencyAvailable()+actualChunkSize,maxConcurrentRecords)),queue.inProgress=!1,batch.inProgress=function(){return!1},console.error("(#"+batch.id+": "+batch.requestIds.length+") - BATCH REQUEST FAILED: Unrecoverable error"),_removePendingRequest(options.recordId),_removePendingRequests(options.recordIds),batch.batchFailure(result,event))},options.remotingOptions.buffer=!1,chunk.length&&batch.inProgress()&&queue.inProgress?(queue.status!=QUEUE_STATUS.RETRY&&(queue.status=QUEUE_STATUS.REQUEST),_serviceCallTemplate(serviceFunction,chunk,options)):void 0}concurrencyAvailable()>actualChunkSize?(concurrencyAvailable(concurrencyAvailable()-actualChunkSize),_execute()):(_printBatches(),queue.status=QUEUE_STATUS.RATELIMITED,concurrencyAvailable.subscribe(function(newVal){isWaiting()&&actualChunkSize<newVal&&(concurrencyAvailable(concurrencyAvailable()-actualChunkSize),_printBatches(),isWaiting(!1),_execute())}))}function _serviceCallTemplate(serviceFunction,firstArgument,options){var serviceArguments=[options.objectToMergeInto,firstArgument,function chunkSuccess(results,event){options.successFunction(results,event)},function fail(result,event){options.failureFunction&&options.failureFunction(result,event)},options.remotingOptions,options.blockUI];return[].splice.apply(serviceArguments,[2,0].concat(options.additionalArguments)),serviceFunction.apply(this,serviceArguments)}_privateContext._recordServiceTemplateBatch=_recordServiceTemplateBatch,_privateContext._serviceCallTemplate=_serviceCallTemplate,self.cacheUnmappedIForces=function(unmappedObjects,callback,serviceOptions){function _execute(){return _cacheObjects(unmappedObjects,serviceOptions,function(results){_.each(results,function(result){_removePendingRequest(result.recordId())}),callback&&callback(results)})}if(!serviceOptions||!serviceOptions.cacheAsync)return _execute();setTimeout(_execute,0)},self._cacheUnmappedIForces=self.cacheUnmappedIForces,self._extend=function(extensionOptions){return extensionOptions.cache=self,LifeCycle.IForceData.IForceCache._extend(extensionOptions)};var hierarchyOrder={LifeCycleUnderwritingBundle:100,LifeCycleLoan:101,LifeCycleRelationship:110,LifeCycleGuarantor:111,LifeCycleBorrower:111,ALifeCycleInvolvement:111,LifeCycleSpreadStatement:200,LifeCycleSpread:300,LifeCycleSpreadStatementPeriod:400,LifeCycleSpreadStatementTotal:500,LifeCycleSpreadStatementRecordTotal:600,LifeCycleSpreadStatementPeriodTotal:700,LifeCycleSpreadStatementRecord:800,LifeCycleSpreadStatementRecordValue:1e3};function _cacheObjects(jsObjs,userOptions,callback){if(!jsObjs||!jsObjs.length)return[];userOptions=userOptions||[],self._stats.inserts=0,self._stats.updates=0,self._stats.parentToChildUpsert=0,self._stats.parentChildToParent=0,self._stats.childToParent=0,self._stats.childParentToChild=0,self._stats.childParentToChildUpsert=0,self._stats.orphanParentToChildLinks=0,self._stats.orphanChildToParentLinks=0;for(var originalSet=[],i=self._stats.orphans=0;i<jsObjs.length;i++){var originalId,originalItem=jsObjs[i];originalItem&&originalItem.recordId&&(originalId=_18Id(originalItem.recordId),-1==originalSet.indexOf(originalId)&&originalSet.push(originalId))}var startTime=new Date,sortStart=new Date;jsObjs.sort(function(a,b){if(!a&&!b||a&&!a.apexType&&b&&!b.apexType)return 0;if(!a&&b||a&&!a.apexType&&b&&b.apexType)return-1;if(a&&!b||a&&a.apexType&&b&&!b.apexType)return 1;var aType=_utils.getApexType(a.apexType),aOrder=(aOrder=hierarchyOrder[aType])||1e4,bType=_utils.getApexType(b.apexType),bOrder=hierarchyOrder[bType];return aOrder<(bOrder=bOrder||1e4)?1:bOrder<aOrder?-1:0});var sortDuration=(new Date-sortStart)/1e3;_app.log("Pre sorted "+jsObjs.length+" in "+sortDuration+"s");var requestedCachedObjects=[],cachedObjects={};function _cacheOne(jsObj){var chain=[],cachedObject=_cacheObject(jsObj,chain,jsObjs,userOptions);cachedObject&&(cachedObjects[_18Id(cachedObject.recordId())]=cachedObject,requestedCachedObjects.push(cachedObject));for(var j=0;j<chain.length;j++){var chainObj=chain[j];cachedObjects[_18Id(chainObj.recordId())]=chainObj}userOptions&&userOptions.cacheAsync&&requestedCachedObjects.length==jsObjs.length&&_done()}function _done(){_app.log("Inserted "+self._stats.inserts+" objects"),_app.log("Updated "+self._stats.updates+" objects"),_app.log("Upserted "+self._stats.parentToChildUpsert+" children into parent arrays"),_app.log("Linked "+self._stats.parentChildToParent+" parents to children"),_app.log("Linked "+self._stats.childToParent+" children to parent objects"),_app.log("Linked "+self._stats.childParentToChild+" parents to child objects"),_app.log("Upserted "+self._stats.childParentToChildUpsert+" children to parent arrays"),_app.log("Processed "+self._stats.orphans+" orphans"),_app.log("  Resulted in "+self._stats.orphanParentToChildLinks+" parent->child links"),_app.log("  and "+self._stats.orphanChildToParentLinks+" child->parent links");var duration=(new Date-startTime)/1e3;_app.log("------ all in "+duration+"s");for(var i=0;i<requestedCachedObjects.length;i++){var cachedObject=requestedCachedObjects[i];_utils.isPlaceholder(cachedObject)||userOptions.deferNotifications||_notifyAndRemoveSubscribers(cachedObject)}return callback&&callback(requestedCachedObjects),requestedCachedObjects}for(var j=0;j<jsObjs.length;j++){var jsObj=jsObjs[j];userOptions&&userOptions.cacheAsync?setTimeout(_cacheOne(jsObj),0):_cacheOne(jsObj)}return _done()}function _cacheObject(jsObj,_cacheChain,topLevelObjects,userOptions){userOptions=userOptions||{};var id=ko.unwrap(jsObj.recordId),type=ko.unwrap(jsObj.apexType),existing=self.lookupIForceById(id);if(existing&&_utils.isPlaceholder(jsObj))return existing;var cachedObj,cacheChain=[];if(cacheChain.push.apply(cacheChain,_cacheChain),!jsObj||!_utils.isModelObject(jsObj))return console.warn("Can't cache "+jsObj+" [id: "+id+" , type: "+type+"]"),null;if(_utils.getMappingForObj(jsObj)){var shallowClone=_utils.generateMergeableClone(jsObj);if(shallowClone.isLoaded=!0,existing){if(_utils.willCache(jsObj,cacheChain,topLevelObjects))return existing;_utils.isPlaceholder(existing)&&(shallowClone.__placeholder=!1,existing.__placeholder=!1),_utils.safeMerge(existing,shallowClone,!1,!0),cachedObj=self.lookupIForceById(id),self._stats.updates++}else{var stagingObj=userOptions.readOnly?_utils.constructReadOnly(shallowClone):_utils.constructModel(shallowClone);stagingObj.apexType(shallowClone.apexType),cachedObj=_addObject(stagingObj,userOptions),self._stats.inserts++}if(!cachedObj)return cachedObj;if(cacheChain.push(cachedObj),_utils.isPlaceholder(jsObj))return cachedObj;for(var prop in jsObj)if(jsObj.hasOwnProperty(prop)){var val=jsObj[prop];self._stats.dataPointsProcessed++;var thisPropType=_utils.getTypeForProperty(prop);if(_utils.isChildrenProperty(prop,val))for(var c=0;c<val.length;c++){var child=val[c];if(child){var childPropType,cachedChildObject=_cacheObject(child,cacheChain,topLevelObjects,userOptions);for(var childProp in _utils.mergeInto(cachedObj[prop],cachedChildObject),cachedChildObject){!cachedChildObject.hasOwnProperty(childProp)||(childPropType=_utils.getTypeForProperty(childProp))&&_utils.areTypesMergeable(childPropType,type)&&cachedChildObject[childProp]!=cachedObj&&(cachedChildObject[childProp]=cachedObj,self._stats.parentChildToParent++)}self._stats.parentToChildUpsert++}}else if(_utils.isModelObject(val)||thisPropType){if(!val||!ko.unwrap(val.recordId))continue;var cachedRelatedObject=_cacheObject(val,cacheChain,topLevelObjects,userOptions);self._stats.childToParent++,cachedObj[prop]&&cachedObj[prop]!=cachedRelatedObject&&(cachedObj[prop]=cachedRelatedObject);var relPropType,relType=ko.unwrap(cachedRelatedObject.apexType);for(var relProp in cachedRelatedObject){!cachedRelatedObject.hasOwnProperty(relProp)||(relPropType=_utils.getTypeForProperty(relProp))&&_utils.areTypesMergeable(thisPropType,relType)&&_utils.areTypesMergeable(relPropType,type)&&(ko.unwrap(cachedRelatedObject[relProp])instanceof Array?(self._stats.childParentToChildUpsert++,_utils.mergeInto(cachedRelatedObject[relProp],cachedObj)):(self._stats.childParentToChild++,cachedRelatedObject[relProp]=cachedObj))}}}}else console.error("No mapping for "+id+" ("+type+") . Not caching");return self._stats.totalObjectsCached++,cachedObj}function _addObject(mappedObj,userOptions){if(userOptions=userOptions||{},self.isCached(mappedObj))throw"Tried to overwrite an existing IForce rather than merging";if(!_utils.isTailObject(mappedObj))throw"Tried to cache an IForce that was not isolated";if(mappedObj&&mappedObj.recordId&&mappedObj.apexType){var id=mappedObj.recordId();if(!_18Id(id))throw"Tried to add an IForce w/o a valid id: "+id;return userOptions&&userOptions.readOnly||(_utils.trackChanges(mappedObj),_utils.addKOMappings(mappedObj)),mappedObj.__cached=!0,mappedObj.__retrieve=function(_userOptions,callback){var options={};userOptions&&userOptions.iForceProvider&&(options.iForceProvider=userOptions.iForceProvider,"function"==typeof options.iForceProvider&&(options.iForceProvider=options.iForceProvider())),_.extend(options,_userOptions),self.loadIForceById(mappedObj.recordId(),options,callback)},mappedObj.__save=function(_userOptions,callback){LifeCycle.LiteForceService.saveIForce(mappedObj,function(jsForce){self.cacheUnmappedIForces([jsForce],function(updated){callback&&1==updated.length&&callback(updated[0])})})},_iForceMap[_18Id(id)]=mappedObj,self._stats.uniqueObjectsCached++,mappedObj}console.warn("Tried to add an object that was not a valid IForce")}_privateContext._cacheObjects=_cacheObjects,_privateContext._cacheObject=_cacheObject,_privateContext._addObject=_addObject;var pendingRequests=ko.observableArray();function _isPending(id){if(18!=_18Id(id).length)throw"Invalid SFDC Id: "+id;return-1!=pendingRequests.indexOf(_18Id(id))}function _addPendingRequest(id){_isPending(id)||pendingRequests.push(_18Id(id))}function _addPendingRequests(ids){for(var i=0;i<ids.length;i++)_addPendingRequest(ids[i])}function _removePendingRequest(id){var index=pendingRequests.indexOf(_18Id(id));pendingRequests.splice(index,1)}function _removePendingRequests(ids){for(var i=0;i<ids.length;i++)_removePendingRequest(ids[i])}function _trimPendingRequests(ids){for(var nonPendingIds=[],i=0;i<ids.length;i++){var id=ids[i];if(18!=_18Id(id).length)throw"Invalid SFDC Id: "+id;_isPending(id)||nonPendingIds.push(id)}return nonPendingIds}function IdSubscription(id,context,callback){this.id=id,this.context=context,this.callback=callback}_privateContext._isPending=_isPending,_privateContext._addPendingRequest=_addPendingRequest,_privateContext._addPendingRequests=_addPendingRequests,_privateContext._removePendingRequest=_removePendingRequest,_privateContext._removePendingRequests=_removePendingRequests,_privateContext._trimPendingRequests=_trimPendingRequests,IdSubscription.create=function(id,context,callback){!function _subscribeToId(id15Or18,subscription){var id=_18Id(id15Or18),subscriberList=idSubscriptions[id];subscriberList||(subscriberList=[],idSubscriptions[id]=subscriberList);subscriberList.push(subscription)}(id,new IdSubscription(id,context,callback))},IdSubscription.prototype.notify=function(iForce){this.callback.call(this.context,iForce)},_privateContext.IdSubscription=IdSubscription;var idSubscriptions={};function _notifyAndRemoveSubscribers(iForce){if(!_utils.isPlaceholder(iForce)){var id=_18Id(ko.unwrap(iForce.recordId)),subscriberList=idSubscriptions[id];if(subscriberList){for(var subscriber,subscribers=[],i=0;i<subscriberList.length;i++)(subscriber=subscriberList[i])instanceof IdSubscription?subscriber.notify(iForce):console.warn("IForceCache: Load subscriber is not an IdSubscription"),subscribers.push(subscriber);for(var j=subscribers.length-1;0<=j;j--){subscriber=subscribers[j];var index=subscriberList.indexOf(subscriber);subscriberList.splice(index,1)}}}}_privateContext._unsubscribeFromId=function _unsubscribeFromId(id15Or18,subscription){var index,id=_18Id(id15Or18),subscriberList=idSubscriptions[id];!subscriberList||-1!=(index=subscriberList.indexOf(subscription))&&subscriberList.splice(index,1)},_privateContext._getSubscribers=function _getSubscribers(id15Or18){var id=_18Id(id15Or18),subscriberList=idSubscriptions[id];return subscriberList||[]},_privateContext._notifyAndRemoveSubscribers=_notifyAndRemoveSubscribers;var _iForceMap,_app=_optionalMappingApp||LifeCycle.IForceData._globalMappingApp;function _initializeCache(){if(_iForceMap)for(var _id in _iForceMap)if(_iForceMap.hasOwnProperty(_id)){var obj=_iForceMap[_id];for(var prop in obj)if(obj.hasOwnProperty(prop)){if(ko.isObservable(obj[prop]))if(obj[prop].notifySubscribers=function(){},ko.unwrap(obj[prop])instanceof Array)try{obj[prop].removeAll()}catch(e){}else try{obj[prop](null)}catch(e){}delete obj[prop]}delete _iForceMap[_id]}_iForceMap={},_privateContext._iForceMap=_iForceMap}_initializeCache(),_app.NAMESPACE_PREFIX||(_app.NAMESPACE_PREFIX="c.");var _utils=new LifeCycle.IForceData.IForceUtils(_app);self._reinitializeCache=_initializeCache,self._app=_app,self._utils=_utils,self._liteForceUtils=new LifeCycle.IForceData.LiteForceUtils(_app,_utils),self._recordBatchChunkSize=250,self._maxConcurrentRecords=4e3,self._concurrencyOffset=ko.observable(0),self._concurrencyAvailable=ko.computed({read:function(){return self._concurrencyOffset()+self._maxConcurrentRecords},write:function(value){self._concurrencyOffset(value?value-self._maxConcurrentRecords:0)},deferEvaluation:!0}),self._liteRecordBatchChunkSize=1e3,self._liteMaxConcurrentRecords=5e4,self._liteConcurrencyOffset=ko.observable(0),self._liteConcurrencyAvailable=ko.computed({read:function(){return self._liteConcurrencyOffset()+self._liteMaxConcurrentRecords},write:function(value){self._liteConcurrencyOffset(value?value-self._liteMaxConcurrentRecords:0)},deferEvaluation:!0}),self._batchRetryDelay=500,self._batches=ko.observableArray(),self._batchedIdsCompleted=ko.computed(function(){for(var count=0,batches=self._batches(),i=0;i<batches.length;i++)for(var batch=batches[i],j=0;j<batch.queues.length;j++){count+=batch.queues[j].cachedResults().length}return count}),self._batchedIds=ko.computed(function(){for(var count=0,batches=self._batches(),i=0;i<batches.length;i++){count+=batches[i].requestIds.length}return count}),self._batchETA=function(){for(var recordsPerSecondList=[],batches=self._batches(),multiplier=1.5,totalCount=0,i=0;i<batches.length;i++){for(var batch=batches[i],batchCount=0,j=0;j<batch.queues.length;j++){var queue=batch.queues[j];batchCount+=queue.results().length,multiplier=Math.max(multiplier,queue.chunkFailures)}if(totalCount+=batchCount,batch.flightTime){var rps=batchCount/(batch.flightTime/1e3);if(rps<1e-6)continue;recordsPerSecondList.push(rps)}}if(!recordsPerSecondList.length)return"Unknown";if(self._batchProgress()<30)return"Estimating...";var numQueues=self._maxConcurrentRecords/self._recordBatchChunkSize,avgRPS=recordsPerSecondList.reduce(function(a,b){return a+b},0)/recordsPerSecondList.length,seconds=Math.max(0,self._batchedIds()-totalCount)/(avgRPS*numQueues*(60/self._batchProgress())/multiplier),minutes=Math.floor(seconds/60),secondsLeftover=seconds%60,str="";return 0<minutes&&(str+=minutes.toFixed(0)+"m "),str+=secondsLeftover.toFixed(0),secondsLeftover||(str+="0"),str+="s"};var _etaInterval=null;return self._batchProgress=ko.computed({read:function(){var progressBar=jQuery("#global_batch_progress"),remoteCallCount=self._batchedIds(),remoteCallSuccessCount=self._batchedIdsCompleted(),loadedPercent=_utils.formatPercentageForDisplay(remoteCallSuccessCount/remoteCallCount,0);if(99<loadedPercent)return progressBar.find(".progress-legend").hide(),jQuery("#progress-eta-legend").hide(),progressBar.find(".progress-eta").hide(),progressBar.find(".progress").hide(),void progressBar.find(".progress-text").text("Processing...");progressBar.find(".progress-legend").show(),jQuery("#progress-eta-legend").show(),progressBar.find(".progress-eta").show(),progressBar.find(".progress").show(),progressBar.find(".progress-bar").css("width",loadedPercent+"%"),progressBar.find(".progress-text").text(loadedPercent+"%"),progressBar.find(".progress-eta").text(self._batchETA()),_etaInterval&&clearInterval(_etaInterval);var eta=self._batchETA();return progressBar.find(".progress-eta").text(_utils.formatETAForDisplay(eta)),!isNaN(eta)&&0<eta&&(_etaInterval=setInterval(function(){eta--,progressBar.find(".progress-eta").text(_utils.formatETAForDisplay(eta))},1e3)),loadedPercent}}),self._stats={inserts:0,updates:0,parentToChildUpsert:0,parentChildToParent:0,childToParent:0,childParentToChild:0,childParentToChildUpsert:0,orphanParentToChildLinks:0,orphanChildToParentLinks:0,orphans:0,batchCount:0,idsRequested:0,uniqueObjectsCached:0,totalObjectsCached:0,dataPointsProcessed:0},self.ME_OUTSIDE="How bou dah?",self}IForceCache._extend=function(extensionOptions){var context=extensionOptions&&"object"==typeof extensionOptions.context?extensionOptions.context:{},cache=extensionOptions&&extensionOptions.cache instanceof LifeCycle.IForceData.IForceCache?extensionOptions.cache:new LifeCycle.IForceData.IForceCache,_app=cache._app,_utils=cache._utils,_liteForceUtils=cache._liteForceUtils;function _generateLoaderOptions(userOptions,type){var options={};return extensionOptions.defaultIForceProvider&&(options.iForceProvider=extensionOptions.defaultIForceProvider,options.useLiteForces=extensionOptions.useLiteForces||cache.useLiteForces),type&&(options.placeholderType=type.apexTypes[0]),_.extend(options,userOptions),options}function _generateIsType(context,type){context["_is"+type.transformedName]=function(object){return function _isType(apexTypes,object){for(var i=0;i<apexTypes.length;i++){var type=apexTypes[i];if(_utils.isType(object,type))return!0}return!1}(type.apexTypes,object)}}function _trimIForces(context,type,iForces){if(!iForces)return iForces;for(var trimmedIForces=[],i=0;i<iForces.length;i++){var iForce=iForces[i];context["_is"+type.transformedName](iForce)&&trimmedIForces.push(iForce)}return trimmedIForces}context._app=_app,context._utils=_utils,context._liteForceUtils=_liteForceUtils,context._iForceTypedIdMapServiceTemplate=function(serviceFunction,userOptions,callback){var options=_generateLoaderOptions(userOptions);return cache._iForceTypedIdMapServiceTemplate(serviceFunction,options,callback)},context._iForceIdServiceTemplate=function(serviceFunction,userOptions,callback){var options=_generateLoaderOptions(userOptions);return cache._iForceIdServiceTemplate(serviceFunction,options,callback)},context._iForceServiceTemplate=function(serviceFunction,userOptions,callback){var options=_generateLoaderOptions(userOptions);return cache._iForceServiceTemplate(serviceFunction,options,callback)},context._cacheUnmappedIForces=cache.cacheUnmappedIForces,context.cacheUnmappedIForces=cache.cacheUnmappedIForces;for(var i=0;i<extensionOptions.typeDefinitions.length;i++){var type=extensionOptions.typeDefinitions[i];type.transformedName=type.name.charAt(0).toUpperCase()+type.name.substring(1),type.pluralName||(type.pluralName=type.name+"s"),type.transformedPluralName=type.pluralName.charAt(0).toUpperCase()+type.pluralName.substring(1),_generateIsType(context,type),function _generateRetrievalFunctions(context,type){if(context["get"+type.transformedName+"ById"]=function(id15Or18,userOptions,callback){userOptions=_generateLoaderOptions(userOptions,type);var iForce=cache.getIForceById(id15Or18,userOptions,function(_iForce){context["_is"+type.transformedName](_iForce)&&callback&&callback(_iForce)});if(context["_is"+type.transformedName](iForce))return iForce},context["get"+type.transformedPluralName+"ById"]=function(id15Or18,userOptions,callback){userOptions=_generateLoaderOptions(userOptions,type);var iForces=cache.getIForcesById(id15Or18,userOptions,function(_iForces){callback&&callback(_trimIForces(context,type,_iForces))});return _trimIForces(context,type,iForces)},context["load"+type.transformedName+"ById"]=function(id15Or18,userOptions,callback){userOptions=_generateLoaderOptions(userOptions,type),cache.loadIForceById(id15Or18,userOptions,function(iForce){context["_is"+type.transformedName](iForce)&&callback&&callback(iForce)})},context["load"+type.transformedPluralName+"ById"]=function(id15Or18,userOptions,callback){userOptions=_generateLoaderOptions(userOptions,type),cache.loadIForcesById(id15Or18,userOptions,function(iForces){callback&&callback(_trimIForces(context,type,iForces))})},context["lookup"+type.transformedName+"ById"]=function(id15Or18,userOptions){userOptions=_generateLoaderOptions(userOptions,type);var iForce=cache.lookupIForceById(id15Or18,userOptions);if(context["_is"+type.transformedName](iForce))return iForce},context["lookup"+type.transformedPluralName+"ByName"]=function(name,userOptions){var filter;(userOptions=_generateLoaderOptions(userOptions,type)).filter&&(filter=userOptions.filter,userOptions.filter=function(x){return context["_is"+type.transformedName](x)&&filter(x)});var iForces=cache.lookupIForcesByName(name,userOptions);return _trimIForces(context,type,iForces)},context["lookup"+type.transformedPluralName+"ByProperty"]=function(property,value,userOptions){var filter;(userOptions=_generateLoaderOptions(userOptions,type)).filter&&(filter=userOptions.filter,userOptions.filter=function(x){return context["_is"+type.transformedName](x)&&filter(x)});var iForces=cache.lookupIForcesByProperty(property,value,userOptions);return _trimIForces(context,type,iForces)},context["lookup"+type.transformedPluralName+"ByFilter"]=function(filter,userOptions){userOptions=_generateLoaderOptions(userOptions,type);var iForces=cache.lookupIForcesByFilter(function(x){return context["_is"+type.transformedName](x)&&filter(x)},userOptions);return _trimIForces(context,type,iForces)},type.shortcutProperties)for(var s=0;s<type.shortcutProperties.length;s++){var transformedPropertyName,shortcutProperty=type.shortcutProperties[s];-1==["name","id","recordid","recordids"].indexOf(shortcutProperty.toLowerCase())&&(transformedPropertyName=shortcutProperty.charAt(0).toUpperCase()+shortcutProperty.substring(1),function _generateShortcutProperty(shortcutProperty,transformedPropertyName){context["lookup"+type.transformedPluralName+"By"+transformedPropertyName]=function(value,userOptions){userOptions=_generateLoaderOptions(userOptions,type);var iForces=cache.lookupIForcesByProperty(shortcutProperty,value,userOptions);return _trimIForces(context,type,iForces)}}(shortcutProperty,transformedPropertyName))}if(type.uniqueKeyProperties)for(var u=0;u<type.uniqueKeyProperties.length;u++){var transformedUniquePropertyName,uniqueKeyProperty=type.uniqueKeyProperties[u];-1==["name","id","recordid","recordids"].indexOf(uniqueKeyProperty.toLowerCase())&&(transformedUniquePropertyName=uniqueKeyProperty.charAt(0).toUpperCase()+uniqueKeyProperty.substring(1),function _generateUniqueKeyProperty(uniqueKeyProperty,transformedPropertyName){context["lookup"+type.transformedName+"By"+transformedPropertyName]=function(value,userOptions){userOptions=_generateLoaderOptions(userOptions,type);var iForces=cache.lookupIForcesByProperty(uniqueKeyProperty,value,userOptions),trimmed=_trimIForces(context,type,iForces);if(trimmed&&trimmed.length){if(1==trimmed.length)return trimmed[0];throw new Error("IForce Cache: Unique key lookup produced multiple results")}return null}}(uniqueKeyProperty,transformedUniquePropertyName))}}(context,type),cache==LifeCycle.IForceData.globalCache&&extensionOptions.pubSubNamespace&&(function _generateLoadSubscribes(context,pubSubNamespace,type){_app.subscribe(pubSubNamespace+".Load_"+type.transformedName,function(options){context["load"+type.transformedName+"ById"](options.recordId,options)}),_app.subscribe(pubSubNamespace+".Load_"+type.transformedPluralName,function(options){context["load"+type.transformedPluralName+"ById"](options.recordIds,options)}),_app.subscribe(pubSubNamespace+".Get_Cached_"+type.transformedName,function(options){context["get"+type.transformedName+"ById"](options.recordId,options)}),_app.subscribe(pubSubNamespace+".Get_Cached_"+type.transformedPluralName,function(options){context["get"+type.transformedPluralName+"ById"](options.recordIds,options)})}(context,extensionOptions.pubSubNamespace,type),function _generateIForceHooks(context,pubSubNamespace,type){_app.subscribe("nFORCE.IForce_Data.Loaded_IForce",function _iForceHook(iForce){_utils.isPlaceholder(iForce)||context["_is"+type.transformedName](iForce)&&_app.publish(pubSubNamespace+".Loaded_"+type.transformedName,iForce)}),_app.subscribe("nFORCE.IForce_Data.Cached_IForce",function _cachedIForceHook(iForce){_utils.isPlaceholder(iForce)||context["_is"+type.transformedName](iForce)&&_app.publish(pubSubNamespace+".Cached_"+type.transformedName,iForce)})}(context,extensionOptions.pubSubNamespace,type))}return function _generateGenericFunctions(context){for(var funs=[{name:"getIForceById",optionsPropertyIndex:1},{name:"getIForcesById",optionsPropertyIndex:1},{name:"loadIForceById",optionsPropertyIndex:1},{name:"loadIForcesById",optionsPropertyIndex:1},{name:"lookupIForceById",optionsPropertyIndex:1},{name:"lookupIForcesByName",optionsPropertyIndex:1},{name:"lookupIForcesByProperty",optionsPropertyIndex:2}],i=0;i<funs.length;i++){var fun=funs[i],functionName=fun.name,index=fun.optionsPropertyIndex;context[functionName]=function _aliasTemplate(fun,index){return function(){var args=Array.prototype.slice.call(arguments),userOptions=null;return index==args.length?args.push(userOptions):args[index]&&(userOptions=args[index]),args[index]=_generateLoaderOptions(userOptions),cache[fun].apply(cache[fun],args)}}(functionName,index)}}(context),context},LifeCycle.IForceData.IForceCache=IForceCache}()},23:function(module,exports){function sendLoadMessages(cachedIForces,fresh){msgApp.publish("nFORCE.IForce_Data.Cached_IForces",cachedIForces),fresh&&msgApp.publish("nFORCE.IForce_Data.Loaded_IForces",cachedIForces),_.each(cachedIForces,function(iForce){LifeCycle.IForceCache._utils.isPlaceholder(iForce)||(msgApp.publish("nFORCE.IForce_Data.Cached_IForce",iForce),fresh&&msgApp.publish("nFORCE.IForce_Data.Loaded_IForce",iForce))})}var msgApp;LifeCycle.IForceData||(LifeCycle.IForceData={}),LifeCycle.IForceData.globalCache||(LifeCycle.IForceData._globalMappingApp=new LifeCycle.App,LifeCycle.IForceData.IForceUtils._registerModelCatchall(LifeCycle.IForceData._globalMappingApp),LifeCycle.IForceData.globalCache=new LifeCycle.IForceData.IForceCache,LifeCycle.IForceData.enableSubscribes=!0,(msgApp=LifeCycle.IForceData.globalCache._app).subscribe("nFORCE.IForce_Data.Load_IForce",function(options){LifeCycle.IForceData.enableSubscribes&&LifeCycle.IForceCache.loadIForceById(options.recordId,options,function(iForce){sendLoadMessages([iForce],!0)})}),msgApp.subscribe("nFORCE.IForce_Data.Load_IForces",function(options){LifeCycle.IForceData.enableSubscribes&&LifeCycle.IForceCache.loadIForcesById(options.recordIds,options,function(iForces){sendLoadMessages(iForces,!0)})}),msgApp.subscribe("nFORCE.IForce_Data.Get_Cached_IForce",function(options){LifeCycle.IForceData.enableSubscribes&&LifeCycle.IForceCache.getIForceById(options.recordId,options,function(iForce){sendLoadMessages([iForce],!1)})}),msgApp.subscribe("nFORCE.IForce_Data.Get_Cached_IForces",function(options){LifeCycle.IForceData.enableSubscribes&&LifeCycle.IForceCache.getIForcesById(options.recordIds,options,function(iForces){sendLoadMessages(iForces,!1)})}),msgApp.publish("nFORCE.IForce_Data.Started")),LifeCycle.IForceCache=LifeCycle.IForceData.globalCache},24:function(module,exports){function LiteForceService(){}LiteForceService.REMAP_NAMESPACES={},LiteForceService.remapNamespacesFromDb=function(sObjectContainer,utils){for(var dev in LiteForceService.REMAP_NAMESPACES)if(LiteForceService.REMAP_NAMESPACES.hasOwnProperty(dev)){dev.length&&(dev+="__");var newProp,info,newRelProp,packaged=LiteForceService.REMAP_NAMESPACES[dev]+"__";for(var prop in utils.getNamespace(sObjectContainer.type)===dev&&-1!=sObjectContainer.type.indexOf("__c")&&(sObjectContainer.type=packaged+utils.stripNamespace(sObjectContainer.type)),sObjectContainer.obj){sObjectContainer.obj.hasOwnProperty(prop)&&(utils.getNamespace(prop)!=dev||-1==prop.indexOf("__c")&&-1==prop.indexOf("__r")||(newProp=packaged+utils.stripNamespace(prop),sObjectContainer.obj[newProp]=sObjectContainer.obj[prop],delete sObjectContainer.obj[prop]))}for(var relProp in sObjectContainer.relationshipProperties){sObjectContainer.relationshipProperties.hasOwnProperty(relProp)&&(utils.getNamespace(relProp)!=dev||-1==relProp.indexOf("__c")&&-1==relProp.indexOf("__r")||(info=sObjectContainer.relationshipProperties[relProp],newRelProp=packaged+utils.stripNamespace(relProp),sObjectContainer.relationshipProperties[newRelProp]=sObjectContainer.relationshipProperties[relProp],delete sObjectContainer.relationshipProperties[relProp],sObjectContainer.relationshipProperties[newRelProp]=info.map(function(relName){return utils.getNamespace(relName)!=dev||-1==relName.indexOf("__c")&&-1==relName.indexOf("__r")||(relName=packaged+utils.stripNamespace(relName)),relName})))}}},LiteForceService.remapNamespacesToDb=function(sObjectContainer,utils){for(var dev in LiteForceService.REMAP_NAMESPACES)if(LiteForceService.REMAP_NAMESPACES.hasOwnProperty(dev)){dev.length&&(dev+="__");var newProp,packaged=LiteForceService.REMAP_NAMESPACES[dev]+"__";for(var prop in utils.getNamespace(sObjectContainer.type)===packaged&&-1!=sObjectContainer.type.indexOf("__c")&&(sObjectContainer.type=dev+utils.stripNamespace(sObjectContainer.type)),sObjectContainer.obj){sObjectContainer.obj.hasOwnProperty(prop)&&(utils.getNamespace(prop)!=packaged||-1==prop.indexOf("__c")&&-1==prop.indexOf("__r")||(newProp=dev+utils.stripNamespace(prop),sObjectContainer.obj[newProp]=sObjectContainer.obj[prop],delete sObjectContainer.obj[prop]))}}},LiteForceService.retrieveIForce=function(objToMergeInto,recordId,success,failure,remotingOptions,bBlockUI,liteForceUtils,disableMichUltraForces,arbitraryNamespace){return liteForceUtils=liteForceUtils||LiteForceService._getLiteForceUtils(),LiteForceService.retrieveIForces([objToMergeInto],[recordId],function(results){results.length?success(results[0]):failure(null)},failure,remotingOptions,bBlockUI,liteForceUtils,disableMichUltraForces,arbitraryNamespace)},LiteForceService.retrieveIForces=function(arrayToMergeInto,recordIds,success,failure,remotingOptions,bBlockUI,liteForceUtils,disableMichUltraForces,arbitraryNamespace){var typedFieldList;return liteForceUtils=liteForceUtils||LiteForceService._getLiteForceUtils(),disableMichUltraForces||(typedFieldList=liteForceUtils.getCurrentTypedFieldList(arbitraryNamespace)),LifeCycle.LiteForceServiceFunctions.retrieveLiteForces(arrayToMergeInto,recordIds,function(results){var forces=[];(results=results.map(function(result){return LiteForceService.remapNamespacesFromDb(result,liteForceUtils),result}))&&(forces=liteForceUtils.translateLiteForces(results)),success(forces)},failure,remotingOptions,bBlockUI,typedFieldList)},LiteForceService.saveIForce=function(force,success,failure,remotingOptions,bBlockUI,liteForceUtils){return LiteForceService.saveIForces([force],function(forces){forces.length?success(forces[0]):failure(null)},failure,remotingOptions,bBlockUI,liteForceUtils)},LiteForceService.saveIForces=function(forces,success,failure,remotingOptions,bBlockUI,liteForceUtils){liteForceUtils=liteForceUtils||LiteForceService._getLiteForceUtils();for(var sObjects=[],unNamespacedSObjects=[],i=0;i<forces.length;i++){var force=forces[i],force=liteForceUtils.app.mapToJS(force,{useOptimizedMapper:!0,maxDepth:0}),sObjectContainer=liteForceUtils.mapToDb(force);LiteForceService.remapNamespacesToDb(sObjectContainer,liteForceUtils);var sObject=sObjectContainer.obj,sObjectType=sObjectContainer.type;liteForceUtils.isObjectAndFieldsFullyNamespaced(sObjectContainer)?sObjects.push(sObject):(sObject.sobjectType=sObjectType,unNamespacedSObjects.push(sObject))}var allForces=[],inFlight=0;function _saveSome(service,objects){inFlight++,service({},objects,function(updatedSObjectContainers){inFlight--;for(var i=0;i<updatedSObjectContainers.length;i++){var updatedSObjectContainer=updatedSObjectContainers[i],force=liteForceUtils.mapFromDb(updatedSObjectContainer);allForces.push(force)}inFlight||_done()},failure,remotingOptions,bBlockUI)}function _done(){success(allForces)}sObjects.length&&_saveSome(LifeCycle.LiteForceServiceFunctions.saveSObjects,sObjects),unNamespacedSObjects.length&&_saveSome(LifeCycle.LiteForceServiceFunctions.saveUnNamespacedSObjects,unNamespacedSObjects),sObjects.length||unNamespacedSObjects.length||_done()},LiteForceService.deleteIForce=function(force,success,failure,remotingOptions,bBlockUI,liteForceUtils){return LiteForceService.deleteIForces([force],function(){success()},failure,remotingOptions,bBlockUI,liteForceUtils)},LiteForceService.deleteIForces=function(forces,success,failure,remotingOptions,bBlockUI,liteForceUtils){liteForceUtils=liteForceUtils||LiteForceService._getLiteForceUtils();for(var sObjects=[],i=0;i<forces.length;i++){var force=forces[i];force.__ko_mapping__&&(force=liteForceUtils.app.mapToJS(force,{useOptimizedMapper:!0,maxDepth:0}));var sObject=liteForceUtils.mapToDb(force).obj;for(var prop in sObject)sObject.hasOwnProperty(prop)&&"Id"!=prop&&"sobjectType"!=prop&&delete sObject[prop];sObjects.push(sObject)}return LifeCycle.LiteForceServiceFunctions.deleteSObjects([],sObjects,success,failure,remotingOptions,bBlockUI)},LiteForceService._getLiteForceUtils=function(){return LifeCycle.IForceCache._liteForceUtils||LiteForceService._createLiteForceUtils()},LiteForceService._createLiteForceUtils=function(){var app=new LifeCycle.App,utils=new LifeCycle.IForceData.IForceUtils(app);return new LifeCycle.IForceData.LiteForceUtils(app,utils)},LifeCycle.LiteForceService=LiteForceService}});